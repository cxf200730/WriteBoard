{"remainingRequest":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\src\\components\\Watch.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\src\\components\\Watch.vue","mtime":1627560212567},{"path":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626412951070},{"path":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1626412962269},{"path":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626412951070},{"path":"D:\\a_Main\\7-27本地切片随便发\\WriteBoardWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":1626412960418}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport $ from '../../node_modules/jquery/dist/jquery.js';\r\nimport store from '../store.js';\r\nimport flv from 'flv.js';\r\nexport default {\r\n\tstore,\r\n\tcreated() {\r\n\t\t// if(flv.isSupported()){\r\n\t\t// \tthis.player = flv.createPlayer({\r\n\t\t// \ttype: 'flv',\r\n\t\t// \turl: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t// \tisLive: true,\r\n\t\t// \t});\r\n\t\t// }\r\n\t},\r\n\tdata() {\r\n\t\t\r\n\t\treturn {\r\n\t\t\tops: {\r\n\t\t\t                    vuescroll: {\r\n\t\t\t\t\t\t\t\t\tdetectResize: true,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t                    scrollPanel: {},\r\n\t\t\t                    rail: {\r\n\t\t\t                        keepShow:true\r\n\t\t\t                    },\r\n\t\t\t                    bar: {\r\n\t\t\t                        hoverStyle: true,\r\n\t\t\t                        onlyShowBarOnScroll: false, //是否只有滚动的时候才显示滚动条\r\n\t\t\t                        background: \"#2282ff\",\r\n\t\t\t                    }\r\n\t\t\t                },\r\n\t\t\tshow3: false,\r\n\t\t\tshowmessage:true,\r\n\t\t\tactiveIndex: '1',\r\n\t\t\tdialogFormVisible: false,\r\n\t\t\tplayer: null,\r\n\t\t\tplaying: false,\r\n\t\t\tscreenWidth: 0, //屏幕宽度\r\n\t\t\tscreenHeight: 0, //屏幕高度\r\n\t\t\twebsock: null,\r\n\t\t\tdrawx: 100,\r\n\t\t\tdrawy: 500,\r\n\t\t\t//页面启动自动接连\r\n\t\t\tform: {\r\n\t\t\t\tConnectionDetail: 4,\r\n\t\t\t\tLocalIp: '192.168.51.198',\r\n\t\t\t\tAimIp: '101.34.101.58',\r\n\t\t\t\tUserType: 0,\r\n\t\t\t\t// \"UserName\": store.state.userName,\r\n\t\t\t\t// \"UserCode\": store.state.userCode,\r\n\t\t\t\t// \"CLassCode\": store.state.classCode,\r\n\t\t\t\tUserName: '',\r\n\t\t\t\tUserCode: '17003',\r\n\t\t\t\tCLassCode: '5327',\r\n\t\t\t\tJsonType: 4,\r\n\t\t\t\tJsonData: '登录到服务器',\r\n\t\t\t\tContentSocket: null\r\n\t\t\t},\r\n\t\t\tcountnum: 0,\r\n\t\t\t//坐标点对象\r\n\t\t\tpointObj: null,\r\n\t\t\ttextarea: '',\r\n\t\t\tiscandraw: false,\r\n\t\t\tflag: false,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tpointArray: [],\r\n\t\t\ttestjson: {\r\n\t\t\t\tConnectionDetail: 4,\r\n\t\t\t\tLocalIp: '192.168.51.198',\r\n\t\t\t\tAimIp: '192.168.51.198',\r\n\t\t\t\tUserType: 0,\r\n\t\t\t\tUserName: 123,\r\n\t\t\t\tUserCode: 123,\r\n\t\t\t\tCLassCode: 5327,\r\n\t\t\t\tJsonType: 6,\r\n\t\t\t\tJsonData: '',\r\n\t\t\t\tContentSocket: null\r\n\t\t\t},\r\n\t\t\tChatArray: [],\r\n\t\t\tbgimg: 'http://qwf43oqfq.hn-bkt.clouddn.com/%E6%A1%8C%E9%9D%A2%E5%A3%81%E7%BA%B8.jpg',\r\n\t\t\timgObj: null,\r\n\t\t\timgSrcRoot: 'http://qwf43oqfq.hn-bkt.clouddn.com/',\r\n\t\t\timgData: null,\r\n\t\t\ttemp: [],\r\n\t\t\ttempcount:0,\r\n\t\t\tpdfheight: 0,\r\n\t\t\tpdfwidth: 0,\r\n\t\t\tupPicture: null,\r\n\t\t\tnowPicture: null,\r\n\t\t\timageSrc:\"\"\r\n\t\t};\r\n\t},\r\n\r\n\tmethods: {\r\n\t\ttest(){\r\n\t\t\t\r\n\t\t\t// var Data = \"123456789\"\r\n\t\t\t// var Data1\r\n\t\t\t// var Data2\r\n\t\t\t// var Data3\r\n\t\t\t// Data1 = Data.slice(0,2)\r\n\t\t\t// Data2 = Data.slice(2,4)\r\n\t\t\t// Data3 = Data.slice(4,Data.length)\r\n\t\t\t// console.log(\"这是第一段\" + Data1)\r\n\t\t\t// setTimeout(function () {\r\n\t\t\t//     // 这里就是处理的事件\r\n\t\t\t// \tconsole.log(\"这是第二段\" + Data2)\r\n\t\t\t// }, 500);\r\n\t\t\t// setTimeout(function () {\r\n\t\t\t//     // 这里就是处理的事件\r\n\t\t\t// \tconsole.log(\"这是第三段\" + Data3)\r\n\t\t\t// }, 1000);\r\n\t\t\t// $(\"#chatContent\").scrollTop(0);\r\n\t\t\t\r\n\t\t\tconst that = this\r\n\t\t\tconsole.log(123)\r\n\t\t\tconst { v, h } = this.$refs[\"vs\"].getScrollProcess();\r\n\t\t\tconsole.log(v, h);\r\n\t\t\tif(v != 1){\r\n\t\t\t\tthat.$refs[\"vs\"].scrollTo(\r\n\t\t\t\t  {\r\n\t\t\t\t    y:\"100%\"\r\n\t\t\t\t  },\r\n\t\t\t\t  500\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// $(\"#chatContent\").scrollTop($(\"#chatContent\")[0].scrollHeight);\r\n\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\ttest2(){\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t\tcontext.canvas.height = context.canvas.height;\r\n\t\t\t\r\n\t\t\tthis.canvaspaste()\r\n\t\t},\r\n\t\t handleSelect(key, keyPath) {\r\n\t\t        console.log(key, keyPath);\r\n\t\t      },\r\n\t\tlogin() {\r\n\t\t\tthis.dialogFormVisible = false;\r\n\t\t\tthis.initWebSocket();\r\n\t\t},\r\n\r\n\t\tclearcanvas() {\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t},\r\n\r\n\t\tcanvascopy() {\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tvar width = context.canvas.width;\r\n\t\t\tvar height = context.canvas.height;\r\n\t\t\t\r\n\t\t\tthis.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\tfor(var i = 0; i < this.imgData.data.length; i += 4) {\r\n\t\t\t// 当该像素是透明的,则设置成白色\r\n\t\t\tif(this.imgData.data[i + 3] == 0) {\r\n\t\t\tthis.imgData.data[i] = 255;\r\n\t\t\tthis.imgData.data[i + 1] = 255;\r\n\t\t\tthis.imgData.data[i + 2] = 255;\r\n\t\t\tthis.imgData.data[i + 3] = 255;\r\n\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar newCanvas = $('<canvas>')\r\n\t\t\t\t.attr('width', this.imgData.width)\r\n\t\t\t\t.attr('height', this.imgData.height)[0];\r\n\t\t\t\t\r\n\t\t\tnewCanvas.getContext('2d').putImageData(this.imgData, 0, 0);\r\n\t\t\tthis.temp[this.tempcount] = newCanvas;\r\n\t\t\tconsole.log(\"复制给了\" + this.tempcount)\r\n\t\t\tthis.tempcount++\r\n\t\t},\r\n\r\n\t\tcanvaspaste() {\r\n\t\t\tthis.tempcount--\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tvar width = context.canvas.width;\r\n\t\t\tvar height = context.canvas.height;\r\n\t\t\tcontext.scale(width / this.temp[this.tempcount - 1].width, height / this.temp[this.tempcount - 1].height);\r\n\t\t\tcontext.drawImage(this.temp[this.tempcount - 1], 0, 0);\r\n\t\t\tconsole.log(\"粘贴了\" + this.tempcount)\r\n\t\t\tthis.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\tvar newCanvas = $('<canvas>')\r\n\t\t\t\t.attr('width', this.imgData.width)\r\n\t\t\t\t.attr('height', this.imgData.height)[0];\r\n\t\t\tnewCanvas.getContext('2d').putImageData(this.imgData, 0, 0);\r\n\r\n\t\t\t// context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\tcontext.canvas.width = width;\r\n\t\t\tcontext.canvas.height = height;\r\n\t\t\tcontext.drawImage(newCanvas, 0, 0);\r\n\t\t\t\r\n\t\t\tconsole.log(width + ' + ' + height);\r\n\t\t},\r\n\r\n\t\trevocation() {\r\n\t\t\t// this.canvaspaste();\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t\tthis.canvaspaste();\r\n\t\t},\r\n\r\n\t\tloadImg() {\r\n\t\t\tconst that = this;\r\n\t\t\tvar beauty = new Image();\r\n\t\t\tbeauty.crossOrigin = 'Anonymous'; //这是是需要加的\r\n\t\t\tbeauty.src = this.imgSrcRoot + this.imgObj;\r\n\t\t\tconsole.log(444 + beauty.src);\r\n\t\t\tbeauty.onload = function() {\r\n\t\t\t\t// 等比例缩放图片\r\n\t\t\t\tvar scale = 1;\r\n\t\t\t\tvar mycv = document.getElementById('mycanvas');\r\n\t\t\t\tvar myctx = mycv.getContext('2d');\r\n\t\t\t\tthis.width = mycv.width / 2;\r\n\t\t\t\tthis.height = mycv.height;\r\n\t\t\t\tconsole.log(this.width + '+' + this.height);\r\n\t\t\t\tmyctx.drawImage(this, 0, 0, this.width, this.height); // 加载图片\r\n\t\t\t\t//myctx.drawImage(this, 0, 0)\r\n\t\t\t\tthat.canvascopy();\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tinitCanvas() {\r\n\t\t\tconsole.log('initcanvas');\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t},\r\n\r\n\t\tdrawline() {\r\n\t\t\tconst that = this;\r\n\t\t\tconsole.log('可以画了');\r\n\t\t\tconsole.log(window.innerWidth);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\t// canvas.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.height =  window.innerHeight * 0.85;\r\n\t\t\t// canvas.style.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.style.height =  window.innerHeight * 0.85;\r\n\t\t\tvar canvasWidth = canvas.width;\r\n\t\t\tvar canvasHeight = canvas.height;\r\n\t\t\tcanvas.onmousedown = function(e) {\r\n\t\t\t\tthat.pointArray = [];\r\n\t\t\t\tvar point = {};\r\n\t\t\t\tvar count = [];\r\n\t\t\t\tvar mid = [];\r\n\t\t\t\tvar e = e || window.event;\r\n\t\t\t\tvar ox = e.clientX - window.innerWidth * 0.025;\r\n\t\t\t\tvar oy = e.clientY - window.innerHeight * 0.11;\r\n\t\t\t\tcontext.moveTo(ox, oy);\r\n\r\n\t\t\t\tdocument.onmousemove = function(e) {\r\n\t\t\t\t\t// setTimeout(\"showLogin()\",1000);\r\n\t\t\t\t\tvar e = e || window.event;\r\n\t\t\t\t\tvar ox2 = e.clientX - window.innerWidth * 0.025;\r\n\t\t\t\t\tvar oy2 = e.clientY - window.innerHeight * 0.11;\r\n\r\n\t\t\t\t\tpoint.X = parseFloat(that.BoradWidth - (that.BoradWidth * (e.clientX - window.innerWidth * 0.025)) / canvasWidth).toFixed(4);\r\n\t\t\t\t\tpoint.Y = parseFloat(that.BoradHeight - (that.BoradHeight * (e.clientY - window.innerHeight * 0.11)) / canvasHeight).toFixed(4);\r\n\t\t\t\t\t\r\n\t\t\t\t\tcontext.lineTo(ox2, oy2);\r\n\t\t\t\t\tcontext.stroke();\r\n\t\t\t\t\tcount.push(point);\r\n\t\t\t\t\tpoint = {};\r\n\t\t\t\t\tif(count.length % 12 == 0 ){\r\n\t\t\t\t\t\tfor (var i = 0; i < count.length; i++) {\r\n\t\t\t\t\t\t\tmid.push(count[i]);\r\n\t\t\t\t\t\t\tmid.push(count[i + 2]);\r\n\t\t\t\t\t\t\tthat.pointArray.push(mid);\r\n\t\t\t\t\t\t\tmid = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcount = [];\r\n\t\t\t\t\t\tthat.form.JsonType = 7;\r\n\t\t\t\t\t\tvar msg = JSON.stringify(that.pointArray);\r\n\t\t\t\t\t\tthat.form.JsonData = msg;\r\n\t\t\t\t\t\tthat.countnum++;\r\n\t\t\t\t\t\tthat.pointArray = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdocument.onmouseup = function(e) {\r\n\t\t\t\t\tdocument.onmousemove = null;\r\n\t\t\t\t\tdocument.onmouseup = null;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// for (var i = 0; i < count.length; i++) {\r\n\t\t\t\t\t// \tmid.push(count[i]);\r\n\t\t\t\t\t// \tmid.push(count[i + 1]);\r\n\t\t\t\t\t// \tthat.pointArray.push(mid);\r\n\t\t\t\t\t// \tmid = [];\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// that.form.JsonType = 7;\r\n\t\t\t\t\t// var msg = JSON.stringify(that.pointArray);\r\n\t\t\t\t\t// that.form.JsonData = msg;\r\n\t\t\t\t\t// that.countnum++;\r\n\t\t\t\t\t that.canvascopy();\r\n\t\t\t\t};\r\n\t\t\t};\r\n\r\n\t\t\tconsole.log(1111111111111111111111111111111111111111111111);\r\n\t\t\tconsole.log(canvasWidth);\r\n\t\t\tconsole.log(canvasHeight);\r\n\t\t\tfor (var i = 0; i < this.pointObj.length; i++) {\r\n\t\t\t\tcontext.moveTo(canvasWidth - (this.pointObj[i][0].X / this.BoradWidth) * canvasWidth, canvasHeight - (this.pointObj[i][0].Y / this.BoradHeight) * canvasHeight);\r\n\t\t\t\tcontext.lineTo(canvasWidth - (this.pointObj[i][1].X / this.BoradWidth) * canvasWidth, canvasHeight - (this.pointObj[i][1].Y / this.BoradHeight) * canvasHeight);\r\n\t\t\t\tcontext.strokeStyle = 'black';\r\n\t\t\t\tcontext.lineWidth = 1.5;\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsendMessage() {\r\n\t\t\tconst that = this;\r\n\t\t\tif (this.textarea === null || this.textarea === '' || this.textarea === ' ') {\r\n\t\t\t\talert('别nm发空消息');\r\n\t\t\t} else {\r\n\t\t\t\tthat.form.JsonType = 6;\r\n\t\t\t\tthat.form.JsonData = that.textarea;\r\n\t\t\t\tthat.textarea = null;\r\n\t\t\t\tvar msg = JSON.stringify(that.form);\r\n\t\t\t\tthat.websocketsend(msg);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlogout() {\r\n\t\t\tthis.$router.push('/Login');\r\n\t\t\tthis.websock.close(); //离开路由之后断开websocket连接\r\n\t\t},\r\n\r\n\t\tinitWebSocket() {\r\n\t\t\t//初始化weosocket\r\n\t\t\t//192.168.51.198\r\n\t\t\t//101.34.101.58\r\n\t\t\t// const wsuri = \"ws://192.168.51.132:9999\";\r\n\t\t\t// const wsuri = \"ws://192.168.51.198:9999\";\r\n\t\t\tconst wsuri = 'ws://101.34.101.58:9999';\r\n\t\t\t// const wsuri = 'ws://127.0.0.1:9999';\r\n\t\t\t// const wsuri = 'ws://192.168.51.170:9999';\r\n\t\t\t\r\n\t\t\tthis.websock = new WebSocket(wsuri);\r\n\t\t\tthis.websock.onopen = this.websocketonopen;\r\n\t\t\tthis.websock.onmessage = this.websocketonmessage;\r\n\t\t\tthis.websock.onerror = this.websocketonerror;\r\n\t\t\tthis.websock.onclose = this.websocketclose;\r\n\t\t},\r\n\r\n\t\twebsocketonopen() {\r\n\t\t\t//连接建立之后执行send方法发送数据\r\n\t\t\tvar msg = JSON.stringify(this.form); //转化为json字符串\r\n\t\t\tconsole.log(this.form);\r\n\t\t\tconsole.log(msg);\r\n\t\t\tthis.websocketsend(msg);\r\n\t\t},\r\n\r\n\t\twebsocketonerror() {\r\n\t\t\t//连接建立失败重连\r\n\t\t\talert('正在重新连接');\r\n\t\t},\r\n\r\n\t\twebsocketonmessage(e) {\r\n\t\t\t//数据接收\r\n\t\t\tvar jsonObj = eval('(' + e.data + ')');\r\n\t\t\tconsole.log(jsonObj);\r\n\t\t\tconsole.log(jsonObj.JsonType);\r\n\t\t\tif (jsonObj.JsonData == 'false') {\r\n\t\t\t\talert('登陆失败');\r\n\t\t\t} else {\r\n\t\t\t\tif (jsonObj.JsonData == 'true') {\r\n\t\t\t\t\talert('登陆成功');\r\n\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth;\r\n\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (jsonObj.JsonType == 3) {\r\n\t\t\t\t\t\tconsole.log('这是画线！！');\r\n\t\t\t\t\t\tthis.canvascopy();\r\n\t\t\t\t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t\t\t\tthis.pointObj = pointObj;\r\n\t\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth;\r\n\t\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight;\r\n\t\t\t\t\t\tconsole.log('这是手写版的宽高：' + jsonObj.BoradWidth + jsonObj.BoradHeight);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 8) {\r\n\t\t\t\t\t\tconsole.log('这是pdf！！');\r\n\t\t\t\t\t\t// console.log(\"这是清空画板\")\r\n\t\t\t\t\t\t//  var c=document.getElementById(\"mycanvas\");\r\n\t\t\t\t\t\t//     var cxt=c.getContext(\"2d\");\r\n\t\t\t\t\t\t//     c.height=c.height;\r\n\t\t\t\t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t\t\t\tthis.imgObj = imgObj;\r\n\t\t\t\t\t\tconsole.log(2333 + this.imgObj);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 2) {\r\n\t\t\t\t\t\tconsole.log('这是消息！！');\r\n\t\t\t\t\t\tvar count = {};\r\n\t\t\t\t\t\t(count.TeacherName = jsonObj.UserName), (count.TeacherSay = jsonObj.JsonData), console.log(count);\r\n\t\t\t\t\t\tthis.ChatArray.push(count);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 10) {\r\n\t\t\t\t\t\tconsole.log('这是撤销！！');\r\n\r\n\t\t\t\t\t\tthis.revocation();\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 9) {\r\n\t\t\t\t\t\tconsole.log('这是清空花板！！');\r\n\t\t\t\t\t\tvar c = document.getElementById('mycanvas');\r\n\t\t\t\t\t\tc.height = c.height;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// if(jsonObj.ConnectionDetail = 8){\r\n\t\t\t// \tif(jsonObj.JsonData == \"false\"){\r\n\t\t\t// \tthis.$message.error('登陆失败');\r\n\t\t\t// \t}else{\r\n\t\t\t// \t\tif(jsonObj.JsonType == 4){\r\n\t\t\t// \t\t\tconst that = this\r\n\t\t\t// \t\t this.$message({\r\n\t\t\t// \t\t\t\t  message: '登陆成功',\r\n\t\t\t// \t\t\t\t  type: 'success'\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \tthis.openLogin = false;\r\n\t\t\t// \t\t}\r\n\r\n\t\t\t// \telse if(jsonObj.JsonType == 8){\r\n\t\t\t// \t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t// \t\t\tthis.imgObj = imgObj\r\n\t\t\t// \t\t\tconsole.log(2333+this.imgObj)\r\n\t\t\t// \t\t}else if(jsonObj.JsonType == 3){\r\n\t\t\t// \t\t\tthis.canvascopy();\r\n\t\t\t// \t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t// \t\t\tthis.pointObj = pointObj\r\n\t\t\t// \t\t\tthis.BoradWidth = jsonObj.BoradWidth\r\n\t\t\t// \t\t\tthis.BoradHeight = jsonObj.BoradHeight\r\n\t\t\t// \t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\r\n\t\t\t// \t\t}else{\r\n\t\t\t// \t\t\talert(\"这是其他的\")\r\n\t\t\t// \t\t}\r\n\t\t\t// \t// this.loginbtn = false\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t},\r\n\t\t//数据发送\r\n\t\twebsocketsend(Data) {\r\n\t\t\t// var that= this\r\n\t\t\t// //每个包发1000的数据量\r\n\t\t\t// var count = Data.length / 1000;\r\n\t\t\t// console.log(\"发了\" + Math.ceil(count) + \"次\")\r\n\t\t\t// for(var i = 0; i < Math.ceil(count); i++){\r\n\t\t\t// \t// console.log(Data.slice(1000 * i,1000 * (i + 1)))\r\n\t\t\t// \tvar Data1 = Data.slice(1000 * i,1000 * (i + 1))\r\n\t\t\t\t\r\n\t\t\t// \tsetTimeout(function () {\r\n\t\t\t// \t    // 这里就是处理的事件\r\n\t\t\t// \t\tthat.websock.send(Data1)\r\n\t\t\t// \t}, 100 * i);\r\n\t\t\t// }\r\n\t\t\tif(Data.length > 325000){\r\n\t\t\t\tconsole.log(\"太多了\")\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 260000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tvar Data4;\r\n\t\t\t\tvar Data5;\r\n\t\t\t\tconsole.log('大于260000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,195000)\r\n\t\t\t\tData4 = Data.slice(195000,260000)\r\n\t\t\t\tData5 = Data.slice(260000,Data.length)\r\n\t\t\t\r\n\t\t\t\tthat.websock.send(Data1 + \"Wait\")\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3 + \"Wait\")\r\n\t\t\t\t}, 2000);setTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data4 + \"Wait\")\r\n\t\t\t\t}, 3000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data5)\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 195000 && Data.length < 260000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tvar Data4;\r\n\t\t\t\tconsole.log('大于195000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,195000)\r\n\t\t\t\tData4 = Data.slice(195000,Data.length)\r\n\t\t\t\tthat.websock.send(Data1 + \"Wait\")\r\n\t\t\t\t\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3 + \"Wait\")\r\n\t\t\t\t}, 2000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data4)\r\n\t\t\t\t}, 3000);\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 130000 && Data.length < 195000){\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tconsole.log('大于130000' + Data.length);\r\n\t\t\t\tconst that = this\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,Data.length)\r\n\t\t\t\tconsole.log('第一次发' + Data1.length);\r\n\t\t\t\tconsole.log('第二次发' + Data2.length);\r\n\t\t\t\tconsole.log('第三次发' + Data3.length);\r\n\t\t\t\tthis.websock.send(Data1 + \"Wait\");\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3)\r\n\t\t\t\t}, 2000);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 65000 && Data.length < 130000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tconsole.log('大于65000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,Data.length)\r\n\t\t\t\tthis.websock.send(Data1 + \"Wait\");\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2);\r\n\t\t\t\t}, 1000);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tconsole.log('直接发' + Data.length);\r\n\t\t\t\tthis.websock.send(Data);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\r\n\t\twebsocketclose(e) {\r\n\t\t\t//关闭\r\n\t\t\tconsole.log('断开连接', e);\r\n\t\t}\r\n\t},\r\n\r\n\tmounted() {\r\n\t\t// if (flv.isSupported()) {\r\n\t\t// \t  var videoElement = document.getElementById('myvideo')\r\n\t\t// \t  var flvPlayer = flv.createPlayer({\r\n\t\t// \t   type: 'flv',\r\n\t\t// \t   url: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t// \t     isLive: true,\r\n\t\t// \t\t fluid:true,\r\n\t\t// \t\t// 首帧等待时长\r\n\t\t// \t\t// stashInitialSize: 2\r\n\t\t// \t    // hasAudio: false,//是否有音频轨道\r\n\t\t// \t  },\r\n\t\t// \t  {\r\n\t\t// \t\t   // lazyLoadMaxDuration: 3 * 60,\r\n\t\t// \t\t   // enableWorker: true,\r\n\t\t// \t\t// 启用IO隐藏缓冲区。如果您需要实时（最小延迟）来进行实时流播放，则设置为false，但是如果网络抖动，则可能会停顿。\r\n\t\t//         enableStashBuffer: false,//是否开启播放器端缓存\r\n\t\t// \t\tfixAudioTimestampGap:false,//音视频同步\r\n\t\t// \t\tisLive:true,//是否为直播流\r\n\t\t// \t\t// autoCleanupMaxBackwardDuration:1,\r\n\t\t// \t\t// withCredentials: false,\r\n\t\t// \t\t // cors: true,\r\n\t\t//                      },\r\n\t\t// \t\t\t\t\t\t)\r\n\t\t// \t  flvPlayer.attachMediaElement(videoElement)\r\n\t\t// \t  flvPlayer.load()\r\n\t\t// \t  flvPlayer.play()\r\n\t\t// }\r\n\r\n\t\tvar _this = this;\r\n\t\twindow.onresize = function() {\r\n\t\t\t// 定义窗口大小变更通知事件\r\n\t\t\t_this.screenWidth = document.documentElement.clientWidth; //窗口宽度\r\n\t\t\t_this.screenHeight = document.documentElement.clientHeight; //窗口高度\r\n\t\t\tconsole.log(document.documentElement.clientWidth);\r\n\t\t\tconsole.log(document.documentElement.clientWidth);\r\n\t\t};\r\n\r\n\t\tthis.initCanvas();\r\n\t\t// this.initWebSocket()\r\n\t\tthis.drawline();\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tgetuserCode() {\r\n\t\t\treturn this.$store.state.userCode;\r\n\t\t},\r\n\t\tgetclassCode() {\r\n\t\t\treturn this.$store.state.classCode;\r\n\t\t}\r\n\t},\r\n\r\n\twatch: {\r\n\t\tChatArray: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\t$(\"#chatContent\").scrollTop($(\"#chatContent\")[0].scrollHeight);\r\n\t\t\t}\r\n\t\t},\r\n\t\tpointObj: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\tthis.drawline();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcountnum: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\t\r\n\t\t\t\tvar msg = JSON.stringify(this.form);\r\n\t\t\t\tthis.websocketsend(msg);\r\n\t\t\t\t\r\n\t\t\t\tthis.drawline();\r\n\t\t\t}\r\n\t\t},\r\n\t\timgObj: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\tthis.loadImg();\r\n\t\t\t}\r\n\t\t},\r\n\t\tscreenWidth: function(val) {\r\n\t\t\t//监听屏幕宽度变化\r\n\t\t\tconsole.log(123456);\r\n\t\t\tconsole.log(this.imgData);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t\tconsole.log(window.innerWidth);\r\n\r\n\t\t\tthis.canvaspaste();\r\n\t\t},\r\n\t\tscreenHeight: function() {\r\n\t\t\t//监听屏幕高度变化\r\n\t\t\tconsole.log(123456);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t\tthis.canvaspaste();\r\n\t\t}\r\n\t}\r\n};\r\n",{"version":3,"sources":["Watch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Watch.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<el-container style=\"height: 100%;width: 100%;\">\r\n\t\t\r\n\t\t<!-- 头部 -->\r\n\t\t<el-header height=\"7%\">\r\n\t\t\t<div><span>金奥绘画教学平台</span></div>\r\n\t\t\t<el-button type=\"infor\" @click=\"dialogFormVisible = true\">登录</el-button>\r\n\t\t\t<el-button type=\"infor\" @click = \"test\">滚动条</el-button>\r\n\t\t\t<el-button type=\"infor\" @click = \"test2\">撤销</el-button>\r\n\t\t</el-header>\r\n\r\n\t\t<!-- 除头部区域 -->\r\n\t\t<el-container style=\"height: 93%;\">\r\n\t\t\t<!-- 左边绘画区 -->\r\n\t\t\t<div style=\"position: absolute;left:40%\">\r\n\t\t\t   <el-button @click=\"show3 = !show3\" icon = \"iconfont icon-xiala\" v-if=\"!show3\" ></el-button>\r\n\t\t\t\t<el-button @click=\"show3 = !show3\" icon = \"iconfont icon-shang1\" v-if=\"show3\"></el-button>\r\n\t\t\t   <div v-show=\"show3\" style=\"margin-top: 20px; height: 50px;position: absolute;z-index: 100;transform: translateX(-44%);\">\r\n\t\t\t     <el-collapse-transition>\r\n\t\t\t       <div v-show=\"show3\">\r\n\t\t\t        <div class=\"transition-box\" style=\"height: 50px;width: 700px;background-color: #bab4ab;\">\r\n\t\t\t\t\t\t<el-button type=\"primary\" icon=\"iconfont icon-jushou\" style=\"background-color: #409eff;transform: translateY(-20px);\" @click = \"handsup\" ></el-button>\r\n\t\t\t\t\t\t<el-button @click = \"test2\" type=\"primary\" icon=\"iconfont icon-chexiao\" style=\"background-color: #409eff;transform: translateY(-20px);margin-left: 30px;\"></el-button>\r\n\t\t\t\t\t\t<el-button type=\"primary\" icon=\"iconfont icon-qingkonghuancun\" style=\"background-color: #409eff;transform: translateY(-20px);margin-left: 30px;\"></el-button>\r\n\t\t\t\t\t\t<el-button type=\"primary\" icon=\"iconfont icon-huabi1\" style=\"background-color: #409eff;transform: translateY(-20px);margin-left: 30px;\"  ></el-button>\r\n\t\t\t\t\t\t<el-button  type=\"primary\" icon=\"iconfont icon-huabigongju-tuya\" style=\"background-color: #409eff;transform: translateY(-20px);margin-left: 30px;\"></el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t       </div>\r\n\t\t\t     </el-collapse-transition>\r\n\t\t\t   </div>\r\n\t\t\t </div>\r\n\t\t\t<el-aside width=\"80%\" style = \"background-image: linear-gradient(#bbb5ac, #847c74);\">\r\n\t\t\t\t\r\n\t\t\t\t<div style=\"width: 95%;height: 90%;margin:auto;text-align: center; transform: translateY(5%);\" id=\"canv\">\r\n\t\t\t\t\t<canvas id=\"mycanvas\" width=\"400\" height=\"400\" style=\"background-color: white;\"></canvas>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<!-- <el-button  type=\"warning\" icon=\"el-icon-star-off\" circle size=\"mini\" @click = \"candraw\"  id=\"unmuteButton\"></el-button> -->\r\n\t\t\t</el-aside>\r\n\r\n\t\t\t<!-- 右侧区域 -->\r\n\t\t\t<el-container>\r\n\t\t\t\t<!-- 右上角视频区域 -->\r\n\t\t\t\t<el-main style=\"height: 20%\">\r\n\t\t\t\t\t<div style=\"height: 100%;width: 100%;text-align: center;padding: 0;\"><video id=\"myvideo\" style=\"width: 200px;height: 95%;\"></video></div>\r\n\t\t\t\t</el-main>\r\n\r\n\t\t\t\t<!-- 右侧聊天区 -->\r\n\t\t\t\t<el-footer height=\"70%\" style=\" background-image: linear-gradient(#e66465, #9198e5); padding: 5%;\" class=\"messagefooter\">\r\n\t\t\t\t\t<div class=\"messagediv\" style=\"background-color: white;border-radius: 2%;\">\r\n\t\t\t\t\t\t<el-card class=\"box-card\" style=\"background-color: white;\" >\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t <div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t\t    <el-menu :default-active=\"activeIndex\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"handleSelect\">\r\n\t\t\t\t\t\t\t      <el-menu-item index=\"1\" @click = \"showmessage = true\">消息</el-menu-item>\r\n\t\t\t\t\t\t\t      <el-menu-item index=\"2\" @click = \"showmessage = false\">学生列表</el-menu-item>\r\n\t\t\t\t\t\t\t    </el-menu>\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t<!-- <div class=\"text item\" v-for=\"message in ChatArray\" :key=\"message\">\r\n\t\t\t\t\t\t\t\t{{ message.TeacherName }}:{{ message.TeacherSay }}\r\n\t\t\t\t\t\t\t\t<el-divider></el-divider>\r\n\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t\t\t<vue-scroll :ops=\"ops\" class=\"text item\" style = \"\"  id=\"chatContent\" ref=\"vs\"> \r\n\t\t\t\t\t\t\t\t<div class=\"text item\" v-for=\" i in 15\" :key=\"i\" v-if=\"showmessage\" style=\"width: 95%;\">\r\n\t\t\t\t\t\t\t\t\t第{{ i }}条消息\r\n\t\t\t\t\t\t\t\t\t<el-divider></el-divider>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text item\" v-for=\" j in 15\" :key=\"j\" v-if=\"!showmessage\" style=\"width: 95%;\">\r\n\t\t\t\t\t\t\t\t\t第{{ j }}个学生\r\n\t\t\t\t\t\t\t\t\t<el-divider></el-divider>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</vue-scroll>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-footer>\r\n\r\n\t\t\t\t<!-- 右侧发消息区 -->\r\n\t\t\t\t<el-footer height = \"auto\" style=\"background-image: linear-gradient(45deg,#126bae 25%,#2177b8 0,#2177b8 50%,#126bae 0,#126bae 75%,#2177b8 0);\nbackground-size: 80px 80px;padding: 5%;\">\r\n\t\t\t\t\t<div style=\"height: 100%;\">\r\n\t\t\t\t\t\t<el-input type=\"text\" size=\"medium\" clearable v-model=\"textarea\" style=\"  display=inline-block;  width: 70%;\" @keyup.enter.native=\"sendMessage\"></el-input>\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\ticon=\"el-icon-edit\"\r\n\t\t\t\t\t\t\tcircle\r\n\t\t\t\t\t\t\tstyle=\"  display=inline-block;  \r\n\t\t\t\t\t\t\tmargin-left: 15px;\"\r\n\t\t\t\t\t\t\t@click=\"sendMessage\"\r\n\t\t\t\t\t\t></el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-footer>\r\n\t\t\t</el-container>\r\n\t\t</el-container>\r\n\r\n\t\t<!-- 登录DiaLog -->\r\n\t\t<el-dialog title=\"学生登陆\" :visible.sync=\"dialogFormVisible\">\r\n\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t<el-input style=\"width: 85%;margin-top: 10%;\" prefix-icon=\"iconfont icon-yonghu\" v-model=\"form.UserCode\" placeholder=\"请输入学号\"></el-input>\r\n\t\t\t\t<el-input\r\n\t\t\t\t\tstyle=\"width: 85%;margin-top: 5%;\"\r\n\t\t\t\t\tprefix-icon=\"iconfont icon-banjiguanli\"\r\n\t\t\t\t\tv-model=\"form.CLassCode\"\r\n\t\t\t\t\tplaceholder=\"请输入班级号\"\r\n\t\t\t\t\t@keyup.enter.native=\"login\"\r\n\t\t\t\t></el-input>\r\n\t\t\t\t<el-button style=\"width: 85%;margin-top: 15%;height: 50px;\" type=\"primary\" @click=\"login()\">登录</el-button>\r\n\t\t\t</div>\r\n\t\t</el-dialog>\r\n\t</el-container>\r\n</template>\r\n\r\n<script>\r\nimport $ from '../../node_modules/jquery/dist/jquery.js';\r\nimport store from '../store.js';\r\nimport flv from 'flv.js';\r\nexport default {\r\n\tstore,\r\n\tcreated() {\r\n\t\t// if(flv.isSupported()){\r\n\t\t// \tthis.player = flv.createPlayer({\r\n\t\t// \ttype: 'flv',\r\n\t\t// \turl: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t// \tisLive: true,\r\n\t\t// \t});\r\n\t\t// }\r\n\t},\r\n\tdata() {\r\n\t\t\r\n\t\treturn {\r\n\t\t\tops: {\r\n\t\t\t                    vuescroll: {\r\n\t\t\t\t\t\t\t\t\tdetectResize: true,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t                    scrollPanel: {},\r\n\t\t\t                    rail: {\r\n\t\t\t                        keepShow:true\r\n\t\t\t                    },\r\n\t\t\t                    bar: {\r\n\t\t\t                        hoverStyle: true,\r\n\t\t\t                        onlyShowBarOnScroll: false, //是否只有滚动的时候才显示滚动条\r\n\t\t\t                        background: \"#2282ff\",\r\n\t\t\t                    }\r\n\t\t\t                },\r\n\t\t\tshow3: false,\r\n\t\t\tshowmessage:true,\r\n\t\t\tactiveIndex: '1',\r\n\t\t\tdialogFormVisible: false,\r\n\t\t\tplayer: null,\r\n\t\t\tplaying: false,\r\n\t\t\tscreenWidth: 0, //屏幕宽度\r\n\t\t\tscreenHeight: 0, //屏幕高度\r\n\t\t\twebsock: null,\r\n\t\t\tdrawx: 100,\r\n\t\t\tdrawy: 500,\r\n\t\t\t//页面启动自动接连\r\n\t\t\tform: {\r\n\t\t\t\tConnectionDetail: 4,\r\n\t\t\t\tLocalIp: '192.168.51.198',\r\n\t\t\t\tAimIp: '101.34.101.58',\r\n\t\t\t\tUserType: 0,\r\n\t\t\t\t// \"UserName\": store.state.userName,\r\n\t\t\t\t// \"UserCode\": store.state.userCode,\r\n\t\t\t\t// \"CLassCode\": store.state.classCode,\r\n\t\t\t\tUserName: '',\r\n\t\t\t\tUserCode: '17003',\r\n\t\t\t\tCLassCode: '5327',\r\n\t\t\t\tJsonType: 4,\r\n\t\t\t\tJsonData: '登录到服务器',\r\n\t\t\t\tContentSocket: null\r\n\t\t\t},\r\n\t\t\tcountnum: 0,\r\n\t\t\t//坐标点对象\r\n\t\t\tpointObj: null,\r\n\t\t\ttextarea: '',\r\n\t\t\tiscandraw: false,\r\n\t\t\tflag: false,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tpointArray: [],\r\n\t\t\ttestjson: {\r\n\t\t\t\tConnectionDetail: 4,\r\n\t\t\t\tLocalIp: '192.168.51.198',\r\n\t\t\t\tAimIp: '192.168.51.198',\r\n\t\t\t\tUserType: 0,\r\n\t\t\t\tUserName: 123,\r\n\t\t\t\tUserCode: 123,\r\n\t\t\t\tCLassCode: 5327,\r\n\t\t\t\tJsonType: 6,\r\n\t\t\t\tJsonData: '',\r\n\t\t\t\tContentSocket: null\r\n\t\t\t},\r\n\t\t\tChatArray: [],\r\n\t\t\tbgimg: 'http://qwf43oqfq.hn-bkt.clouddn.com/%E6%A1%8C%E9%9D%A2%E5%A3%81%E7%BA%B8.jpg',\r\n\t\t\timgObj: null,\r\n\t\t\timgSrcRoot: 'http://qwf43oqfq.hn-bkt.clouddn.com/',\r\n\t\t\timgData: null,\r\n\t\t\ttemp: [],\r\n\t\t\ttempcount:0,\r\n\t\t\tpdfheight: 0,\r\n\t\t\tpdfwidth: 0,\r\n\t\t\tupPicture: null,\r\n\t\t\tnowPicture: null,\r\n\t\t\timageSrc:\"\"\r\n\t\t};\r\n\t},\r\n\r\n\tmethods: {\r\n\t\ttest(){\r\n\t\t\t\r\n\t\t\t// var Data = \"123456789\"\r\n\t\t\t// var Data1\r\n\t\t\t// var Data2\r\n\t\t\t// var Data3\r\n\t\t\t// Data1 = Data.slice(0,2)\r\n\t\t\t// Data2 = Data.slice(2,4)\r\n\t\t\t// Data3 = Data.slice(4,Data.length)\r\n\t\t\t// console.log(\"这是第一段\" + Data1)\r\n\t\t\t// setTimeout(function () {\r\n\t\t\t//     // 这里就是处理的事件\r\n\t\t\t// \tconsole.log(\"这是第二段\" + Data2)\r\n\t\t\t// }, 500);\r\n\t\t\t// setTimeout(function () {\r\n\t\t\t//     // 这里就是处理的事件\r\n\t\t\t// \tconsole.log(\"这是第三段\" + Data3)\r\n\t\t\t// }, 1000);\r\n\t\t\t// $(\"#chatContent\").scrollTop(0);\r\n\t\t\t\r\n\t\t\tconst that = this\r\n\t\t\tconsole.log(123)\r\n\t\t\tconst { v, h } = this.$refs[\"vs\"].getScrollProcess();\r\n\t\t\tconsole.log(v, h);\r\n\t\t\tif(v != 1){\r\n\t\t\t\tthat.$refs[\"vs\"].scrollTo(\r\n\t\t\t\t  {\r\n\t\t\t\t    y:\"100%\"\r\n\t\t\t\t  },\r\n\t\t\t\t  500\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// $(\"#chatContent\").scrollTop($(\"#chatContent\")[0].scrollHeight);\r\n\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\ttest2(){\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t\tcontext.canvas.height = context.canvas.height;\r\n\t\t\t\r\n\t\t\tthis.canvaspaste()\r\n\t\t},\r\n\t\t handleSelect(key, keyPath) {\r\n\t\t        console.log(key, keyPath);\r\n\t\t      },\r\n\t\tlogin() {\r\n\t\t\tthis.dialogFormVisible = false;\r\n\t\t\tthis.initWebSocket();\r\n\t\t},\r\n\r\n\t\tclearcanvas() {\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t},\r\n\r\n\t\tcanvascopy() {\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tvar width = context.canvas.width;\r\n\t\t\tvar height = context.canvas.height;\r\n\t\t\t\r\n\t\t\tthis.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\tfor(var i = 0; i < this.imgData.data.length; i += 4) {\r\n\t\t\t// 当该像素是透明的,则设置成白色\r\n\t\t\tif(this.imgData.data[i + 3] == 0) {\r\n\t\t\tthis.imgData.data[i] = 255;\r\n\t\t\tthis.imgData.data[i + 1] = 255;\r\n\t\t\tthis.imgData.data[i + 2] = 255;\r\n\t\t\tthis.imgData.data[i + 3] = 255;\r\n\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar newCanvas = $('<canvas>')\r\n\t\t\t\t.attr('width', this.imgData.width)\r\n\t\t\t\t.attr('height', this.imgData.height)[0];\r\n\t\t\t\t\r\n\t\t\tnewCanvas.getContext('2d').putImageData(this.imgData, 0, 0);\r\n\t\t\tthis.temp[this.tempcount] = newCanvas;\r\n\t\t\tconsole.log(\"复制给了\" + this.tempcount)\r\n\t\t\tthis.tempcount++\r\n\t\t},\r\n\r\n\t\tcanvaspaste() {\r\n\t\t\tthis.tempcount--\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tvar width = context.canvas.width;\r\n\t\t\tvar height = context.canvas.height;\r\n\t\t\tcontext.scale(width / this.temp[this.tempcount - 1].width, height / this.temp[this.tempcount - 1].height);\r\n\t\t\tcontext.drawImage(this.temp[this.tempcount - 1], 0, 0);\r\n\t\t\tconsole.log(\"粘贴了\" + this.tempcount)\r\n\t\t\tthis.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\tvar newCanvas = $('<canvas>')\r\n\t\t\t\t.attr('width', this.imgData.width)\r\n\t\t\t\t.attr('height', this.imgData.height)[0];\r\n\t\t\tnewCanvas.getContext('2d').putImageData(this.imgData, 0, 0);\r\n\r\n\t\t\t// context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\tcontext.canvas.width = width;\r\n\t\t\tcontext.canvas.height = height;\r\n\t\t\tcontext.drawImage(newCanvas, 0, 0);\r\n\t\t\t\r\n\t\t\tconsole.log(width + ' + ' + height);\r\n\t\t},\r\n\r\n\t\trevocation() {\r\n\t\t\t// this.canvaspaste();\r\n\t\t\tvar context = document.getElementById('mycanvas').getContext('2d');\r\n\t\t\tcontext.canvas.width = context.canvas.width;\r\n\t\t\tthis.canvaspaste();\r\n\t\t},\r\n\r\n\t\tloadImg() {\r\n\t\t\tconst that = this;\r\n\t\t\tvar beauty = new Image();\r\n\t\t\tbeauty.crossOrigin = 'Anonymous'; //这是是需要加的\r\n\t\t\tbeauty.src = this.imgSrcRoot + this.imgObj;\r\n\t\t\tconsole.log(444 + beauty.src);\r\n\t\t\tbeauty.onload = function() {\r\n\t\t\t\t// 等比例缩放图片\r\n\t\t\t\tvar scale = 1;\r\n\t\t\t\tvar mycv = document.getElementById('mycanvas');\r\n\t\t\t\tvar myctx = mycv.getContext('2d');\r\n\t\t\t\tthis.width = mycv.width / 2;\r\n\t\t\t\tthis.height = mycv.height;\r\n\t\t\t\tconsole.log(this.width + '+' + this.height);\r\n\t\t\t\tmyctx.drawImage(this, 0, 0, this.width, this.height); // 加载图片\r\n\t\t\t\t//myctx.drawImage(this, 0, 0)\r\n\t\t\t\tthat.canvascopy();\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tinitCanvas() {\r\n\t\t\tconsole.log('initcanvas');\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t},\r\n\r\n\t\tdrawline() {\r\n\t\t\tconst that = this;\r\n\t\t\tconsole.log('可以画了');\r\n\t\t\tconsole.log(window.innerWidth);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\t// canvas.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.height =  window.innerHeight * 0.85;\r\n\t\t\t// canvas.style.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.style.height =  window.innerHeight * 0.85;\r\n\t\t\tvar canvasWidth = canvas.width;\r\n\t\t\tvar canvasHeight = canvas.height;\r\n\t\t\tcanvas.onmousedown = function(e) {\r\n\t\t\t\tthat.pointArray = [];\r\n\t\t\t\tvar point = {};\r\n\t\t\t\tvar count = [];\r\n\t\t\t\tvar mid = [];\r\n\t\t\t\tvar e = e || window.event;\r\n\t\t\t\tvar ox = e.clientX - window.innerWidth * 0.025;\r\n\t\t\t\tvar oy = e.clientY - window.innerHeight * 0.11;\r\n\t\t\t\tcontext.moveTo(ox, oy);\r\n\r\n\t\t\t\tdocument.onmousemove = function(e) {\r\n\t\t\t\t\t// setTimeout(\"showLogin()\",1000);\r\n\t\t\t\t\tvar e = e || window.event;\r\n\t\t\t\t\tvar ox2 = e.clientX - window.innerWidth * 0.025;\r\n\t\t\t\t\tvar oy2 = e.clientY - window.innerHeight * 0.11;\r\n\r\n\t\t\t\t\tpoint.X = parseFloat(that.BoradWidth - (that.BoradWidth * (e.clientX - window.innerWidth * 0.025)) / canvasWidth).toFixed(4);\r\n\t\t\t\t\tpoint.Y = parseFloat(that.BoradHeight - (that.BoradHeight * (e.clientY - window.innerHeight * 0.11)) / canvasHeight).toFixed(4);\r\n\t\t\t\t\t\r\n\t\t\t\t\tcontext.lineTo(ox2, oy2);\r\n\t\t\t\t\tcontext.stroke();\r\n\t\t\t\t\tcount.push(point);\r\n\t\t\t\t\tpoint = {};\r\n\t\t\t\t\tif(count.length % 12 == 0 ){\r\n\t\t\t\t\t\tfor (var i = 0; i < count.length; i++) {\r\n\t\t\t\t\t\t\tmid.push(count[i]);\r\n\t\t\t\t\t\t\tmid.push(count[i + 2]);\r\n\t\t\t\t\t\t\tthat.pointArray.push(mid);\r\n\t\t\t\t\t\t\tmid = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcount = [];\r\n\t\t\t\t\t\tthat.form.JsonType = 7;\r\n\t\t\t\t\t\tvar msg = JSON.stringify(that.pointArray);\r\n\t\t\t\t\t\tthat.form.JsonData = msg;\r\n\t\t\t\t\t\tthat.countnum++;\r\n\t\t\t\t\t\tthat.pointArray = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdocument.onmouseup = function(e) {\r\n\t\t\t\t\tdocument.onmousemove = null;\r\n\t\t\t\t\tdocument.onmouseup = null;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// for (var i = 0; i < count.length; i++) {\r\n\t\t\t\t\t// \tmid.push(count[i]);\r\n\t\t\t\t\t// \tmid.push(count[i + 1]);\r\n\t\t\t\t\t// \tthat.pointArray.push(mid);\r\n\t\t\t\t\t// \tmid = [];\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// that.form.JsonType = 7;\r\n\t\t\t\t\t// var msg = JSON.stringify(that.pointArray);\r\n\t\t\t\t\t// that.form.JsonData = msg;\r\n\t\t\t\t\t// that.countnum++;\r\n\t\t\t\t\t that.canvascopy();\r\n\t\t\t\t};\r\n\t\t\t};\r\n\r\n\t\t\tconsole.log(1111111111111111111111111111111111111111111111);\r\n\t\t\tconsole.log(canvasWidth);\r\n\t\t\tconsole.log(canvasHeight);\r\n\t\t\tfor (var i = 0; i < this.pointObj.length; i++) {\r\n\t\t\t\tcontext.moveTo(canvasWidth - (this.pointObj[i][0].X / this.BoradWidth) * canvasWidth, canvasHeight - (this.pointObj[i][0].Y / this.BoradHeight) * canvasHeight);\r\n\t\t\t\tcontext.lineTo(canvasWidth - (this.pointObj[i][1].X / this.BoradWidth) * canvasWidth, canvasHeight - (this.pointObj[i][1].Y / this.BoradHeight) * canvasHeight);\r\n\t\t\t\tcontext.strokeStyle = 'black';\r\n\t\t\t\tcontext.lineWidth = 1.5;\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsendMessage() {\r\n\t\t\tconst that = this;\r\n\t\t\tif (this.textarea === null || this.textarea === '' || this.textarea === ' ') {\r\n\t\t\t\talert('别nm发空消息');\r\n\t\t\t} else {\r\n\t\t\t\tthat.form.JsonType = 6;\r\n\t\t\t\tthat.form.JsonData = that.textarea;\r\n\t\t\t\tthat.textarea = null;\r\n\t\t\t\tvar msg = JSON.stringify(that.form);\r\n\t\t\t\tthat.websocketsend(msg);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlogout() {\r\n\t\t\tthis.$router.push('/Login');\r\n\t\t\tthis.websock.close(); //离开路由之后断开websocket连接\r\n\t\t},\r\n\r\n\t\tinitWebSocket() {\r\n\t\t\t//初始化weosocket\r\n\t\t\t//192.168.51.198\r\n\t\t\t//101.34.101.58\r\n\t\t\t// const wsuri = \"ws://192.168.51.132:9999\";\r\n\t\t\t// const wsuri = \"ws://192.168.51.198:9999\";\r\n\t\t\tconst wsuri = 'ws://101.34.101.58:9999';\r\n\t\t\t// const wsuri = 'ws://127.0.0.1:9999';\r\n\t\t\t// const wsuri = 'ws://192.168.51.170:9999';\r\n\t\t\t\r\n\t\t\tthis.websock = new WebSocket(wsuri);\r\n\t\t\tthis.websock.onopen = this.websocketonopen;\r\n\t\t\tthis.websock.onmessage = this.websocketonmessage;\r\n\t\t\tthis.websock.onerror = this.websocketonerror;\r\n\t\t\tthis.websock.onclose = this.websocketclose;\r\n\t\t},\r\n\r\n\t\twebsocketonopen() {\r\n\t\t\t//连接建立之后执行send方法发送数据\r\n\t\t\tvar msg = JSON.stringify(this.form); //转化为json字符串\r\n\t\t\tconsole.log(this.form);\r\n\t\t\tconsole.log(msg);\r\n\t\t\tthis.websocketsend(msg);\r\n\t\t},\r\n\r\n\t\twebsocketonerror() {\r\n\t\t\t//连接建立失败重连\r\n\t\t\talert('正在重新连接');\r\n\t\t},\r\n\r\n\t\twebsocketonmessage(e) {\r\n\t\t\t//数据接收\r\n\t\t\tvar jsonObj = eval('(' + e.data + ')');\r\n\t\t\tconsole.log(jsonObj);\r\n\t\t\tconsole.log(jsonObj.JsonType);\r\n\t\t\tif (jsonObj.JsonData == 'false') {\r\n\t\t\t\talert('登陆失败');\r\n\t\t\t} else {\r\n\t\t\t\tif (jsonObj.JsonData == 'true') {\r\n\t\t\t\t\talert('登陆成功');\r\n\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth;\r\n\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (jsonObj.JsonType == 3) {\r\n\t\t\t\t\t\tconsole.log('这是画线！！');\r\n\t\t\t\t\t\tthis.canvascopy();\r\n\t\t\t\t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t\t\t\tthis.pointObj = pointObj;\r\n\t\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth;\r\n\t\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight;\r\n\t\t\t\t\t\tconsole.log('这是手写版的宽高：' + jsonObj.BoradWidth + jsonObj.BoradHeight);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 8) {\r\n\t\t\t\t\t\tconsole.log('这是pdf！！');\r\n\t\t\t\t\t\t// console.log(\"这是清空画板\")\r\n\t\t\t\t\t\t//  var c=document.getElementById(\"mycanvas\");\r\n\t\t\t\t\t\t//     var cxt=c.getContext(\"2d\");\r\n\t\t\t\t\t\t//     c.height=c.height;\r\n\t\t\t\t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t\t\t\tthis.imgObj = imgObj;\r\n\t\t\t\t\t\tconsole.log(2333 + this.imgObj);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 2) {\r\n\t\t\t\t\t\tconsole.log('这是消息！！');\r\n\t\t\t\t\t\tvar count = {};\r\n\t\t\t\t\t\t(count.TeacherName = jsonObj.UserName), (count.TeacherSay = jsonObj.JsonData), console.log(count);\r\n\t\t\t\t\t\tthis.ChatArray.push(count);\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 10) {\r\n\t\t\t\t\t\tconsole.log('这是撤销！！');\r\n\r\n\t\t\t\t\t\tthis.revocation();\r\n\t\t\t\t\t} else if (jsonObj.JsonType == 9) {\r\n\t\t\t\t\t\tconsole.log('这是清空花板！！');\r\n\t\t\t\t\t\tvar c = document.getElementById('mycanvas');\r\n\t\t\t\t\t\tc.height = c.height;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// if(jsonObj.ConnectionDetail = 8){\r\n\t\t\t// \tif(jsonObj.JsonData == \"false\"){\r\n\t\t\t// \tthis.$message.error('登陆失败');\r\n\t\t\t// \t}else{\r\n\t\t\t// \t\tif(jsonObj.JsonType == 4){\r\n\t\t\t// \t\t\tconst that = this\r\n\t\t\t// \t\t this.$message({\r\n\t\t\t// \t\t\t\t  message: '登陆成功',\r\n\t\t\t// \t\t\t\t  type: 'success'\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \tthis.openLogin = false;\r\n\t\t\t// \t\t}\r\n\r\n\t\t\t// \telse if(jsonObj.JsonType == 8){\r\n\t\t\t// \t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t// \t\t\tthis.imgObj = imgObj\r\n\t\t\t// \t\t\tconsole.log(2333+this.imgObj)\r\n\t\t\t// \t\t}else if(jsonObj.JsonType == 3){\r\n\t\t\t// \t\t\tthis.canvascopy();\r\n\t\t\t// \t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t// \t\t\tthis.pointObj = pointObj\r\n\t\t\t// \t\t\tthis.BoradWidth = jsonObj.BoradWidth\r\n\t\t\t// \t\t\tthis.BoradHeight = jsonObj.BoradHeight\r\n\t\t\t// \t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\r\n\t\t\t// \t\t}else{\r\n\t\t\t// \t\t\talert(\"这是其他的\")\r\n\t\t\t// \t\t}\r\n\t\t\t// \t// this.loginbtn = false\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t},\r\n\t\t//数据发送\r\n\t\twebsocketsend(Data) {\r\n\t\t\t// var that= this\r\n\t\t\t// //每个包发1000的数据量\r\n\t\t\t// var count = Data.length / 1000;\r\n\t\t\t// console.log(\"发了\" + Math.ceil(count) + \"次\")\r\n\t\t\t// for(var i = 0; i < Math.ceil(count); i++){\r\n\t\t\t// \t// console.log(Data.slice(1000 * i,1000 * (i + 1)))\r\n\t\t\t// \tvar Data1 = Data.slice(1000 * i,1000 * (i + 1))\r\n\t\t\t\t\r\n\t\t\t// \tsetTimeout(function () {\r\n\t\t\t// \t    // 这里就是处理的事件\r\n\t\t\t// \t\tthat.websock.send(Data1)\r\n\t\t\t// \t}, 100 * i);\r\n\t\t\t// }\r\n\t\t\tif(Data.length > 325000){\r\n\t\t\t\tconsole.log(\"太多了\")\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 260000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tvar Data4;\r\n\t\t\t\tvar Data5;\r\n\t\t\t\tconsole.log('大于260000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,195000)\r\n\t\t\t\tData4 = Data.slice(195000,260000)\r\n\t\t\t\tData5 = Data.slice(260000,Data.length)\r\n\t\t\t\r\n\t\t\t\tthat.websock.send(Data1 + \"Wait\")\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3 + \"Wait\")\r\n\t\t\t\t}, 2000);setTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data4 + \"Wait\")\r\n\t\t\t\t}, 3000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data5)\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 195000 && Data.length < 260000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tvar Data4;\r\n\t\t\t\tconsole.log('大于195000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,195000)\r\n\t\t\t\tData4 = Data.slice(195000,Data.length)\r\n\t\t\t\tthat.websock.send(Data1 + \"Wait\")\r\n\t\t\t\t\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3 + \"Wait\")\r\n\t\t\t\t}, 2000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data4)\r\n\t\t\t\t}, 3000);\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 130000 && Data.length < 195000){\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tvar Data3;\r\n\t\t\t\tconsole.log('大于130000' + Data.length);\r\n\t\t\t\tconst that = this\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,130000)\r\n\t\t\t\tData3 = Data.slice(130000,Data.length)\r\n\t\t\t\tconsole.log('第一次发' + Data1.length);\r\n\t\t\t\tconsole.log('第二次发' + Data2.length);\r\n\t\t\t\tconsole.log('第三次发' + Data3.length);\r\n\t\t\t\tthis.websock.send(Data1 + \"Wait\");\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2 + \"Wait\")\r\n\t\t\t\t}, 1000);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data3)\r\n\t\t\t\t}, 2000);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse if(Data.length > 65000 && Data.length < 130000){\r\n\t\t\t\tconst that = this\r\n\t\t\t\tvar Data1;\r\n\t\t\t\tvar Data2;\r\n\t\t\t\tconsole.log('大于65000' + Data.length);\r\n\t\t\t\tData1 = Data.slice(0,65000)\r\n\t\t\t\tData2 = Data.slice(65000,Data.length)\r\n\t\t\t\tthis.websock.send(Data1 + \"Wait\");\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t    // 这里就是处理的事件\r\n\t\t\t\t\tthat.websock.send(Data2);\r\n\t\t\t\t}, 1000);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tconsole.log('直接发' + Data.length);\r\n\t\t\t\tthis.websock.send(Data);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\r\n\t\twebsocketclose(e) {\r\n\t\t\t//关闭\r\n\t\t\tconsole.log('断开连接', e);\r\n\t\t}\r\n\t},\r\n\r\n\tmounted() {\r\n\t\t// if (flv.isSupported()) {\r\n\t\t// \t  var videoElement = document.getElementById('myvideo')\r\n\t\t// \t  var flvPlayer = flv.createPlayer({\r\n\t\t// \t   type: 'flv',\r\n\t\t// \t   url: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t// \t     isLive: true,\r\n\t\t// \t\t fluid:true,\r\n\t\t// \t\t// 首帧等待时长\r\n\t\t// \t\t// stashInitialSize: 2\r\n\t\t// \t    // hasAudio: false,//是否有音频轨道\r\n\t\t// \t  },\r\n\t\t// \t  {\r\n\t\t// \t\t   // lazyLoadMaxDuration: 3 * 60,\r\n\t\t// \t\t   // enableWorker: true,\r\n\t\t// \t\t// 启用IO隐藏缓冲区。如果您需要实时（最小延迟）来进行实时流播放，则设置为false，但是如果网络抖动，则可能会停顿。\r\n\t\t//         enableStashBuffer: false,//是否开启播放器端缓存\r\n\t\t// \t\tfixAudioTimestampGap:false,//音视频同步\r\n\t\t// \t\tisLive:true,//是否为直播流\r\n\t\t// \t\t// autoCleanupMaxBackwardDuration:1,\r\n\t\t// \t\t// withCredentials: false,\r\n\t\t// \t\t // cors: true,\r\n\t\t//                      },\r\n\t\t// \t\t\t\t\t\t)\r\n\t\t// \t  flvPlayer.attachMediaElement(videoElement)\r\n\t\t// \t  flvPlayer.load()\r\n\t\t// \t  flvPlayer.play()\r\n\t\t// }\r\n\r\n\t\tvar _this = this;\r\n\t\twindow.onresize = function() {\r\n\t\t\t// 定义窗口大小变更通知事件\r\n\t\t\t_this.screenWidth = document.documentElement.clientWidth; //窗口宽度\r\n\t\t\t_this.screenHeight = document.documentElement.clientHeight; //窗口高度\r\n\t\t\tconsole.log(document.documentElement.clientWidth);\r\n\t\t\tconsole.log(document.documentElement.clientWidth);\r\n\t\t};\r\n\r\n\t\tthis.initCanvas();\r\n\t\t// this.initWebSocket()\r\n\t\tthis.drawline();\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tgetuserCode() {\r\n\t\t\treturn this.$store.state.userCode;\r\n\t\t},\r\n\t\tgetclassCode() {\r\n\t\t\treturn this.$store.state.classCode;\r\n\t\t}\r\n\t},\r\n\r\n\twatch: {\r\n\t\tChatArray: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\t$(\"#chatContent\").scrollTop($(\"#chatContent\")[0].scrollHeight);\r\n\t\t\t}\r\n\t\t},\r\n\t\tpointObj: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\tthis.drawline();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcountnum: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\t\r\n\t\t\t\tvar msg = JSON.stringify(this.form);\r\n\t\t\t\tthis.websocketsend(msg);\r\n\t\t\t\t\r\n\t\t\t\tthis.drawline();\r\n\t\t\t}\r\n\t\t},\r\n\t\timgObj: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler: function(newVal, oldVal) {\r\n\t\t\t\tthis.loadImg();\r\n\t\t\t}\r\n\t\t},\r\n\t\tscreenWidth: function(val) {\r\n\t\t\t//监听屏幕宽度变化\r\n\t\t\tconsole.log(123456);\r\n\t\t\tconsole.log(this.imgData);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t\tconsole.log(window.innerWidth);\r\n\r\n\t\t\tthis.canvaspaste();\r\n\t\t},\r\n\t\tscreenHeight: function() {\r\n\t\t\t//监听屏幕高度变化\r\n\t\t\tconsole.log(123456);\r\n\t\t\tvar canvas = document.getElementById('mycanvas');\r\n\t\t\tvar context = canvas.getContext('2d');\r\n\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.height = window.innerHeight * 0.85;\r\n\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\tcanvas.style.height = window.innerHeight * 0.85;\r\n\t\t\tthis.canvaspaste();\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.el-header {\r\n\tbackground-color: #373d41;\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\tpadding-left: 20px;\r\n\talign-items: center;\r\n\tcolor: #ffffff;\r\n\tfont-size: 20px;\r\n\t> div {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\t> span {\r\n\t\t\tmargin-left: 20px;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.messagediv {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\t.el-card /deep/ .el-card__body {\r\n\t\t\r\n\t\theight: 90%;\r\n\t\t\r\n\t}\r\n.el-card /deep/ .el-card__header {\r\n\t\t    padding: 0px;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\t\t\r\n\t.box-card {\r\n\t\twidth: 100%;\r\n\r\n\t\tbackground-color: white;\r\n\t\ttext-align: left;\r\n\t\toverflow-y: hidden;\r\n\t\toverflow-x: hidden;\r\n\r\n\t\theight: 100%;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t.el-menu--horizontal > .el-menu-item{\r\n\t\t\theight: 40px;\r\n\t\t\tline-height: 40px;\r\n\t\t}\r\n\t\t\r\n\t\t.text {\r\n\t\t\tfont-size: 15px;\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\t\t.item {\r\n\t\t\tline-height: 20px;\r\n\t\t}\r\n\t\t.el-divider {\r\n\t\t\tmargin: 10px 0;\r\n\t\t\tbackground: 0 0;\r\n\t\t\tborder-top: 1px solid #c5c5d5;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.el-footer {\r\n\tbackground-color: #b3c0d1;\r\n\t// background-color: #f9f4dc;\r\n\tcolor: #333;\r\n\ttext-align: center;\r\n\tline-height: 100%;\r\n}\r\n\r\n.el-aside {\r\n\tbackground-color: rgb(#ced6e0);\r\n\ttext-align: center;\r\n}\r\n\r\n.el-main {\r\n\tbackground-color: black;\r\n\tcolor: #333;\r\n\ttext-align: center;\r\n\tpadding: 0;\r\n}\r\n\r\n.transition-box {\r\n\t    margin-bottom: 10px;\r\n\t    border-radius: 4px;\r\n\t    background-color: #409EFF;\r\n\t    text-align: center;\r\n\t    color: #fff;\r\n\t    padding: 40px 20px;\r\n\t    box-sizing: border-box;\r\n\t    margin-right: 20px;\r\n\t  }\r\n</style>\n"]}]}