{"remainingRequest":"D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\src\\components\\Watch.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\src\\components\\Watch.vue","mtime":1627123269214},{"path":"D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1626412962269},{"path":"D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626412951070},{"path":"D:\\a_Main\\HBuildX7-23优化撤销 显示username\\WriteBoardWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":1626412960418}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport $ from '../../node_modules/jquery/dist/jquery.js'\n\timport store from '../store.js'\n\timport flv from 'flv.js'\nexport default {\n\tstore,\n\tcreated(){\n\t\tif(flv.isSupported()){\n\t\t\tthis.player = flv.createPlayer({\n\t\t\ttype: 'flv',\n\t\t\turl: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\n\t\t\tisLive: true,\n\t\t\t});\n\t\t}\n\t},\n\t\n\tdata(){\n\t\treturn{\n\t\t\tdialogFormVisible :false,\n\t\t\tplayer : null,\n\t\t\tplaying: false,\n\t\t\tscreenWidth: 0,//屏幕宽度\n\t\t\tscreenHeight: 0,//屏幕高度\n\t\t\twebsock:null,\n\t\t\tdrawx:100,\n\t\t\tdrawy:500,\n\t\t\t//页面启动自动接连\n\t\t\tform:{\n\t\t\t\t\"ConnectionDetail\": 4,\n\t\t\t\t\"LocalIp\": \"192.168.51.198\",\n\t\t\t\t\"AimIp\": \"101.34.101.58\",\n\t\t\t\t\"UserType\": 0,\n\t\t\t\t// \"UserName\": store.state.userName,\n\t\t\t\t// \"UserCode\": store.state.userCode,\n\t\t\t\t// \"CLassCode\": store.state.classCode,\n\t\t\t\t\"UserName\": \"\",\n\t\t\t\t\"UserCode\": \"17003\",\n\t\t\t\t\"CLassCode\": \"5327\",\n\t\t\t\t\"JsonType\": 4,\n\t\t\t\t\"JsonData\": \"登录到服务器\",\n\t\t\t\t\"ContentSocket\": null\n\t\t\t},\n\t\t\tcountnum:0,\n\t\t\t//坐标点对象\n\t\t\tpointObj:null,\n\t\t\ttextarea: '',\n\t\t\tiscandraw:false,\n\t\t\tflag: false,\n\t\t\t  x: 0,\n\t\t\t  y: 0,\n\t\t\tpointArray:[],\n\t\t\ttestjson:{\"ConnectionDetail\":4,\"LocalIp\":\"192.168.51.198\",\"AimIp\":\"192.168.51.198\",\"UserType\":0,\n\t\t\t\"UserName\":123,\"UserCode\":123,\"CLassCode\":5327,\"JsonType\":6,\n\t\t\t\"JsonData\":\"\",\n\t\t\t\"ContentSocket\":null},\n\t\t\tChatArray:[],\n\t\t\tbgimg:\"http://qwf43oqfq.hn-bkt.clouddn.com/%E6%A1%8C%E9%9D%A2%E5%A3%81%E7%BA%B8.jpg\",\n\t\t\timgObj:null,\n\t\t\timgSrcRoot:'http://qwf43oqfq.hn-bkt.clouddn.com/',\n\t\t\timgData:null,\n\t\t\ttemp: null,\n\t\t\tpdfheight:0,\n\t\t\tpdfwidth:0,\n\t\t\tupPicture:null,\n\t\t\tnowPicture:null,\n\t\t}\n\t},\n\t\n\tmethods:{\n\t\tlogin(){\n\t\t\tthis.dialogFormVisible = false\n\t\t\tthis.initWebSocket()\n\t\t},\n\t\t\n\t\tclearcanvas(){\n\t\t\tvar context = document.getElementById(\"mycanvas\").getContext('2d');\n\t\t\t context.canvas.width = context.canvas.width;\n\t\t},\n\t\t\n\t\tcanvascopy(){\n\t\t          var context = document.getElementById(\"mycanvas\").getContext('2d');\n\t\t          var width = context.canvas.width;\n\t\t          var height = context.canvas.height;\n\t\t          this.imgData = context.getImageData(0, 0, width, height);\n\t\t\t\t  var newCanvas = $(\"<canvas>\")\n\t\t\t\t      .attr(\"width\", this.imgData.width)\n\t\t\t\t      .attr(\"height\", this.imgData.height)[0];\n\t\t\t\t  newCanvas.getContext(\"2d\").putImageData(this.imgData, 0, 0);\n\t\t\t\t  this.temp = newCanvas\n\t\t      },\n\t\t\n\t\tcanvaspaste(){\n\t\t        var context = document.getElementById(\"mycanvas\").getContext('2d');\n\t\t\t\tvar width = context.canvas.width;\n\t\t\t\tvar height = context.canvas.height;\n\t\t\t\tcontext.scale(width / this.temp.width ,height / this.temp.height)\n\t\t       context.drawImage(this.temp,0,0)\n\t\t\t   \n\t\t\t   this.imgData = context.getImageData(0, 0, width, height);\n\t\t\t   var newCanvas = $(\"<canvas>\")\n\t\t\t       .attr(\"width\", this.imgData.width)\n\t\t\t       .attr(\"height\", this.imgData.height)[0];\n\t\t\t   newCanvas.getContext(\"2d\").putImageData(this.imgData, 0, 0);\n\t\t\t   \n\t\t\t   // context = document.getElementById(\"mycanvas\").getContext('2d');\n\t\t\t   context.canvas.width  = width\n\t\t\t   context.canvas.height  = height\n\t\t\t    context.drawImage(newCanvas,0,0)\n\t\t\t   \n\t\t\t\tconsole.log(width + \" + \" + height)\n\t\t},\n\t\t\n\t\trevocation(){\n\t\t\t// this.canvaspaste();\n\t\t\tvar context = document.getElementById(\"mycanvas\").getContext('2d');\n\t\t\t context.canvas.width = context.canvas.width;\n\t\t\tthis.canvaspaste()\n\t\t},\n\t\t\n\t\tloadImg(){\n\t\t\tconst that = this\n\t\t\tvar beauty = new Image()\n\t\t\tbeauty.crossOrigin = 'Anonymous' //这是是需要加的\n\t\t\tbeauty.src = this.imgSrcRoot+this.imgObj\n\t\t\tconsole.log(444+beauty.src)\n\t\t\tbeauty.onload = function(){\n\t\t\t\t// 等比例缩放图片\n\t\t\t\tvar scale = 1;\n\t\t\t\tvar mycv = document.getElementById(\"mycanvas\")\n\t\t\t\tvar myctx = mycv.getContext(\"2d\")\n\t\t\t\tthis.width = mycv.width/2\n\t\t\t\tthis.height = mycv.height\n\t\t\t\tconsole.log(this.width + \"+\" + this.height)\n\t\t\t\tmyctx.drawImage(this, 0, 0, this.width, this.height);  // 加载图片\n\t\t\t\t//myctx.drawImage(this, 0, 0)\n\t\t\t\tthat.canvascopy()\n\t\t    };\n\t\t},\n\t\t\n\t\tinitCanvas(){\n\t\t\tconsole.log(\"initcanvas\")\n\t\t\t\tvar canvas = document.getElementById(\"mycanvas\")\n\t\t\t\tvar context = canvas.getContext('2d')\n\t\t\t\tcanvas.width = window.innerWidth * 0.75;\n\t\t\t\tcanvas.height =  window.innerHeight * 0.85;\n\t\t\t\tcanvas.style.width = window.innerWidth * 0.75;\n\t\t\t\tcanvas.style.height =  window.innerHeight * 0.85;\n\t\t},\n\t\t\n\t\tdrawline(){\n\t\t\tconst that = this\n\t\t\tconsole.log(\"可以画了\")\n\t\t\tconsole.log(window.innerWidth)\n\t\t\tvar canvas = document.getElementById(\"mycanvas\")\n\t\t\tvar context = canvas.getContext('2d')\n\t\t\t// canvas.width = window.innerWidth * 0.75;\n\t\t\t// canvas.height =  window.innerHeight * 0.85;\n\t\t\t// canvas.style.width = window.innerWidth * 0.75;\n\t\t\t// canvas.style.height =  window.innerHeight * 0.85;\n\t\t\tvar canvasWidth = canvas.width\n\t\t\tvar canvasHeight = canvas.height\n\t\t\tcanvas.onmousedown = function(e){\n\t\t\t\tthat.pointArray = []\n\t\t\t\tvar point = {}\n\t\t\t\tvar count = []\n\t\t\t\tvar mid = []\n\t\t\t\tvar e = e ||window.event;\n\t\t\t\tvar ox = e.clientX - window.innerWidth * 0.025 ;\n\t\t\t\tvar oy = e.clientY - window.innerHeight * 0.11;\n\t\t\t\tcontext.moveTo(ox,oy);\n\t\t\t\t\n\t\t\t\tdocument.onmousemove = function(e){\n\t\t\t\t\t// setTimeout(\"showLogin()\",1000); \n\t\t\t\t\tvar e = e || window.event; \n\t\t\t\t\tvar ox2 = e.clientX -  window.innerWidth * 0.025 ;\n\t\t\t\t\tvar oy2 = e.clientY - window.innerHeight * 0.11;\n\t\t\t\t\t\n\t\t\t\t\tpoint.X = parseFloat(that.BoradWidth - ((that.BoradWidth * (e.clientX -  window.innerWidth * 0.025)) / canvasWidth)).toFixed(4);\n\t\t\t\t\tpoint.Y =  parseFloat(that.BoradHeight - ((that.BoradHeight * (e.clientY -  window.innerHeight * 0.11)) / canvasHeight)).toFixed(4);\n\t\t\t\t\tconsole.log(point.X + \"+++\" + point.Y)\n\t\t\t\t\tcontext.lineTo(ox2,oy2);\n\t\t\t\t\tcontext.stroke();\n\t\t\t\t\tcount.push(point)\n\t\t\t\t\tpoint = {}\n\t\t\t\t}\n\t\t\t\t\t\t\t \n\t\t\t\tdocument.onmouseup  = function(e){\n\t\t\t\t\tdocument.onmousemove =null;\n\t\t\t\t\tdocument.onmouseup = null;\n\t\t\t\t\tfor(var i = 0;i < count.length; i++){\n\t\t\t\t\t   mid.push(count[i]) \n\t\t\t\t\t   mid.push(count[i + 1])\n\t\t\t\t\t   that.pointArray.push(mid)\n\t\t\t\t\t   mid = []\n\t\t\t\t\t}\n\t\t\t\t\tthat.form.JsonType = 7\n\t\t\t\t\tvar msg = JSON.stringify(that.pointArray)\n\t\t\t\t\tthat.form.JsonData = msg\n\t\t\t\t\tthat.countnum++ \n\t\t\t\t\tthat.canvascopy()\n\t\t\t\t}\n\t\t\t\t\t   \n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconsole.log(1111111111111111111111111111111111111111111111)\n\t\t\t\tconsole.log(canvasWidth)\n\t\t\t\tconsole.log(canvasHeight)\n\t\t\t\tfor(var i = 0;i < this.pointObj.length; i++){\n\t\t\t\t\tcontext.moveTo(canvasWidth - this.pointObj[i][0].X  / this.BoradWidth *canvasWidth,canvasHeight - this.pointObj[i][0].Y / this.BoradHeight *canvasHeight) \n\t\t\t\t\tcontext.lineTo(canvasWidth - this.pointObj[i][1].X / this.BoradWidth *canvasWidth,canvasHeight - this.pointObj[i][1].Y / this.BoradHeight *canvasHeight)\n\t\t\t\t\tcontext.strokeStyle = \"black\"\n\t\t\t\t\tcontext.lineWidth = 1.5;\n\t\t\t\t\tcontext.stroke()\n\t\t\t\t}\n\t\t\t},\n\t\t\n\t\tsendMessage(){\n\t\t\tconst that = this\n\t\t\tif(this.textarea === null || this.textarea === '' || this.textarea === \" \"){\n\t\t\t\talert(\"别nm发空消息\")\n\t\t\t}else{\n\t\t\t\tthat.form.JsonType = 6\n\t\t\t\tthat.form.JsonData = that.textarea\n\t\t\t\tthat.textarea = null\n\t\t\t\tvar msg = JSON.stringify(that.form);\n\t\t\t\tthat.websocketsend(msg)\n\t\t\t}\n\t\t},\n\t\t\n\t\tlogout(){\n\t\t\tthis.$router.push(\"/Login\")\n\t\t\tthis.websock.close() //离开路由之后断开websocket连接\n\t\t},\n\n\t\tinitWebSocket(){ //初始化weosocket\n\t\t\t//192.168.51.198\n\t\t\t//101.34.101.58\n\t\t\t// const wsuri = \"ws://192.168.51.132:9999\"; \n\t\t\t// const wsuri = \"ws://192.168.51.198:9999\"; \n\t\t\tconst wsuri = \"ws://101.34.101.58:9999\";    \n\t\t\tthis.websock = new WebSocket(wsuri);\n\t\t\tthis.websock.onopen = this.websocketonopen;\n\t\t\tthis.websock.onmessage = this.websocketonmessage;\n\t\t\tthis.websock.onerror = this.websocketonerror;\n\t\t\tthis.websock.onclose = this.websocketclose;\n\t\t},\n\t\t\n\t\twebsocketonopen(){ //连接建立之后执行send方法发送数据\n\t\t\tvar msg = JSON.stringify(this.form);//转化为json字符串\n\t\t\tconsole.log(this.form);\n\t\t\tconsole.log(msg); \n\t\t\tthis.websocketsend(msg);\n\t\t},\n\t\t\n\t\twebsocketonerror(){//连接建立失败重连\n\t\t\talert(\"正在重新连接\");\n\t\t},\n\t\t\n\t\twebsocketonmessage(e){ //数据接收\n\t\t\tvar jsonObj = eval('(' + e.data + ')');\n\t\t\tconsole.log(jsonObj)\n\t\t\tconsole.log(jsonObj.JsonType)\n\t\t\tif(jsonObj.JsonData == \"false\"){\n\t\t\t\talert(\"登陆失败\")\n\t\t\t}else{\n\t\t\t\tif(jsonObj.JsonData == \"true\"){\n\t\t\t\t\talert(\"登陆成功\")\n\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth\n\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight\n\t\t\t\t}else{\n\t\t\t\t\tif(jsonObj.JsonType == 3){\n\t\t\t\t\t\tconsole.log(\"这是画线！！\");\n\t\t\t\t\t\tthis.canvascopy();\n\t\t\t\t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\n\t\t\t\t\t\tthis.pointObj = pointObj\n\t\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth\n\t\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight\n\t\t\t\t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\n\t\t\t\t\t}else if(jsonObj.JsonType == 8){\n\t\t\t\t\t\tconsole.log(\"这是pdf！！\");\n\t\t\t\t\t\t// console.log(\"这是清空画板\")\n\t\t\t\t\t\t//  var c=document.getElementById(\"mycanvas\");  \n\t\t\t\t\t\t//     var cxt=c.getContext(\"2d\");  \n\t\t\t\t\t\t//     c.height=c.height;  \n\t\t\t\t\t\tvar imgObj = jsonObj.JsonData;\n\t\t\t\t\t\tthis.imgObj = imgObj\n\t\t\t\t\t\tconsole.log(2333+this.imgObj)\n\t\t\t\t\t}\n\t\t\t\t\telse if(jsonObj.JsonType == 2){\n\t\t\t\t\t\tconsole.log(\"这是消息！！\");\n\t\t\t\t\t\tvar count = {}\n\t\t\t\t\t\tcount.TeacherName = jsonObj.UserName,\n\t\t\t\t\t\tcount.TeacherSay = jsonObj.JsonData,\n\t\t\t\t\t\tconsole.log(count)\n\t\t\t\t\t\tthis.ChatArray.push(count)\n\t\t\t\t\t}else if(jsonObj.JsonType == 10){\n\t\t\t\t\t\tconsole.log(\"这是撤销！！\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.revocation();\n\t\t\t\t\t}else if(jsonObj.JsonType == 9){\n\t\t\t\t\t\tconsole.log(\"这是清空花板！！\");\n\t\t\t\t\t\tvar c=document.getElementById(\"mycanvas\");\n\t\t\t\t\t\tc.height=c.height;  \n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if(jsonObj.ConnectionDetail = 8){\n\t\t\t// \tif(jsonObj.JsonData == \"false\"){\n\t\t\t// \tthis.$message.error('登陆失败');\n\t\t\t// \t}else{\n\t\t\t// \t\tif(jsonObj.JsonType == 4){\n\t\t\t// \t\t\tconst that = this\n\t\t\t// \t\t this.$message({\n\t\t\t// \t\t\t\t  message: '登陆成功',\n\t\t\t// \t\t\t\t  type: 'success'\n\t\t\t// \t\t\t\t});\n\t\t\t// \tthis.openLogin = false;\n\t\t\t// \t\t}\n\t\t\t\t\t\n\t\t\t// \telse if(jsonObj.JsonType == 8){\n\t\t\t// \t\t\tvar imgObj = jsonObj.JsonData;\n\t\t\t// \t\t\tthis.imgObj = imgObj\n\t\t\t// \t\t\tconsole.log(2333+this.imgObj)\n\t\t\t// \t\t}else if(jsonObj.JsonType == 3){\n\t\t\t// \t\t\tthis.canvascopy();\n\t\t\t// \t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\n\t\t\t// \t\t\tthis.pointObj = pointObj\n\t\t\t// \t\t\tthis.BoradWidth = jsonObj.BoradWidth\n\t\t\t// \t\t\tthis.BoradHeight = jsonObj.BoradHeight\n\t\t\t// \t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\n\t\t\t// \t\t}else{\n\t\t\t// \t\t\talert(\"这是其他的\")\n\t\t\t// \t\t}\n\t\t\t// \t// this.loginbtn = false\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t},\n\t\t\n\t\twebsocketsend(Data){//数据发送\n\t\t\tconsole.log(111 + Data)\n\t\t\tconsole.log(\"这是数据长度\" + Data.length )\n\t\t\tthis.websock.send(Data);\n\t\t},\n\t\t\n\t\twebsocketclose(e){  //关闭\n\t\t\tconsole.log('断开连接',e);\n\t\t},\t\n\t\n\t},\n\t\n\tmounted() {\n\t\tif (flv.isSupported()) {\n\t\t\t  var videoElement = document.getElementById('myvideo')\n\t\t\t  var flvPlayer = flv.createPlayer({\n\t\t\t   type: 'flv',\n\t\t\t   url: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\n\t\t\t     isLive: true,\n\t\t\t\t fluid:true,\n\t\t\t\t// 首帧等待时长\n\t\t\t\t// stashInitialSize: 2\n\t\t\t    // hasAudio: false,//是否有音频轨道\n\t\t\t  },\n\t\t\t  {\n\t\t\t\t   // lazyLoadMaxDuration: 3 * 60,\n\t\t\t\t   // enableWorker: true,\n\t\t\t\t// 启用IO隐藏缓冲区。如果您需要实时（最小延迟）来进行实时流播放，则设置为false，但是如果网络抖动，则可能会停顿。\n\t\t        enableStashBuffer: false,//是否开启播放器端缓存\n\t\t\t\tfixAudioTimestampGap:false,//音视频同步\n\t\t\t\tisLive:true,//是否为直播流\n\t\t\t\t// autoCleanupMaxBackwardDuration:1,\n\t\t\t\t// withCredentials: false,\n\t\t\t\t // cors: true,        \n\t\t                     },\n\t\t\t\t\t\t\t\t)\n\t\t\t  flvPlayer.attachMediaElement(videoElement)\n\t\t\t  flvPlayer.load()\n\t\t\t  flvPlayer.play()\n\t\t} \n\t\t\n\t\tvar _this = this;\n\t\t\t\t\t\twindow.onresize = function(){ // 定义窗口大小变更通知事件\n\t\t                _this.screenWidth = document.documentElement.clientWidth; //窗口宽度\n\t\t                _this.screenHeight = document.documentElement.clientHeight; //窗口高度\n\t\t\t\t\t\tconsole.log(document.documentElement.clientWidth)\n\t\t\t\t\t\tconsole.log(document.documentElement.clientWidth)\n\t\t\t\t\t\t\n\t\t            };\n\t\t\t\t\t\n\t\t\t\t\tthis.initCanvas()\n\t\t\t\t\t// this.initWebSocket()\n\t\t\t\t\tthis.drawline()\n\t\t\n\t},\n\t\n\tcomputed:{\n\t\tgetuserCode(){\n\t\t\treturn this.$store.state.userCode;\n\t\t},\n\t\tgetclassCode(){\n\t\t   return this.$store.state.classCode;\n\t\t},\n\t\t\n\t },\n\t\n\twatch:{\n\t       pointObj: {\n\t         deep: true,\n\t         handler: function (newVal,oldVal){\n\t\t\t\t this.drawline()\n\t         }\n\t       },\n\n\t\t   countnum: {\n\t\t     deep: true,\n\t\t     handler: function (newVal,oldVal){\n\t\t\t\tvar msg = JSON.stringify(this.form);\n\t\t   \t\tthis.websocketsend(msg)\n\t\t\t\tthis.drawline()\n\t\t     }\n\t\t   },\n\t\timgObj: {\n\t\t\t\t deep: true,\n\t\t\t\t handler: function (newVal,oldVal){\n\t\t\t\t\t this.loadImg()  \n\t\t\t\t\t\n\t\t\t\t }\n\t\t},\n\t\t'screenWidth':function(val){ //监听屏幕宽度变化\n\t\t\tconsole.log(123456)\n\t\t\t\t\t\tconsole.log(this.imgData)\n\t\t                var canvas = document.getElementById(\"mycanvas\")\n\t\t                var context = canvas.getContext('2d')\n\t\t                canvas.width = window.innerWidth * 0.75;\n\t\t                canvas.height =  window.innerHeight * 0.85;\n\t\t                canvas.style.width = window.innerWidth * 0.75;\n\t\t                canvas.style.height =  window.innerHeight * 0.85;\n\t\t\t\t\t\tconsole.log(window.innerWidth)\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.canvaspaste()\n\t\t            },\n\t\t'screenHeight':function(){ //监听屏幕高度变化\n\t\t\tconsole.log(123456)\n\t\t   var canvas = document.getElementById(\"mycanvas\")\n\t\t   var context = canvas.getContext('2d')\n\t\t   canvas.width = window.innerWidth * 0.75;\n\t\t   canvas.height =  window.innerHeight * 0.85;\n\t\t   canvas.style.width = window.innerWidth * 0.75;\n\t\t   canvas.style.height =  window.innerHeight * 0.85;\n\t\t   this.canvaspaste()\n\t\t}\n\t},\n\t   \n}\n",{"version":3,"sources":["Watch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Watch.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<el-container style = \"height: 100%;width: 100%;\">\r\n\t\t<!-- 头部 -->\r\n\t\t<el-header height = 7%>\r\n\t\t\t<div>\r\n\t\t\t\t<span>金奥绘画教学平台</span>\r\n\t\t\t</div>\r\n\t\t\t<el-button type = \"infor\" @click = \"dialogFormVisible  = true\">登录</el-button>\r\n\t\t\t<el-button type = \"infor\" >退出</el-button>\r\n\t\t</el-header>\r\n\t\t\r\n\t\t<!-- 除头部区域 -->\r\n\t\t<el-container style = \"height: 93%;\">\r\n\t\t\t<!-- 左边绘画区 -->\r\n\t\t\t<el-aside  width = 80%>\r\n\t\t\t\t<div style=\"width: 95%;height: 90%;margin:auto;text-align: center; transform: translateY(5%);\" id = \"canv\">\r\n\t\t\t\t\t<canvas id = \"mycanvas\" width=\"400\" height=\"400\" \r\n\t\t\t\t\tstyle=\"background-color: white;\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t</canvas>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t<!-- <el-button  type=\"warning\" icon=\"el-icon-star-off\" circle size=\"mini\" @click = \"candraw\"  id=\"unmuteButton\"></el-button> -->\r\n\t\t\t</el-aside>\r\n\t\t\r\n\t\t\t<!-- 右侧区域 -->\r\n\t\t\t<el-container >\r\n\t\t\t\t\r\n\t\t\t\t<!-- 右上角视频区域 -->\r\n\t\t\t\t<el-main style=\"height: 20%\">\r\n\t\t\t\t\t<div style=\"height: 100%;width: 100%;text-align: center;padding: 0;\">\r\n\t\t\t\t\t\t<video id=\"myvideo\" style=\"width: 200px;height: 95%;\"></video>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-main >\r\n\t\t\t  \r\n\t\t\t\t<!-- 右侧聊天区 -->\r\n\t\t\t\t<el-footer height=70% style = \"background-color: #005C5F;padding: 5%;\" class = \"messagefooter\">\r\n\t\t\t\t\t<div class=\"messagediv\" style=\"background-color: white;border-radius: 2%;\">\r\n\t\t\t\t\t\t<el-card class=\"box-card\"style=\"background-color: white;\" >\r\n\t\t\t\t\t\t  <div class=\"text item\" v-for=\"message in ChatArray\" :key=\"message\">\r\n\t\t\t\t\t\t\t{{message.TeacherName}}:{{message.TeacherSay}}\r\n\t\t\t\t\t\t\t<el-divider>\r\n\t\t\t\t\t\t\t</el-divider>\r\n\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-footer>\r\n\t\t\r\n\t\t\t\t<!-- 右侧发消息区 -->\r\n\t\t\t\t<el-footer height=10% style=\"background-color:#ffa502;padding: 5%;\">\r\n\t\t\t\t\t<div style=\"height: 100%;\">\r\n\t\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tsize=\"medium\" \r\n\t\t\t\t\t\t\tclearable\r\n\t\t\t\t\t\t\tv-model=\"textarea\"\r\n\t\t\t\t\t\t\tstyle=\"  display=inline-block;  width: 70%;\"\r\n\t\t\t\t\t\t\t@keyup.enter.native =\"sendMessage\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t<el-button type=\"primary\" icon=\"el-icon-edit\" circle style=\"  display=inline-block;  \r\n\t\t\t\t\t\t\tmargin-left: 15px;\" @click = \"sendMessage\" >\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-footer>\r\n\t\t\r\n\t\t\t</el-container>\r\n\t  </el-container>\r\n\t  \r\n\t  <!-- 登录DiaLog -->\r\n\t  <el-dialog title=\"学生登陆\" :visible.sync=\"dialogFormVisible\">\r\n\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t<el-input style=\"width: 85%;margin-top: 10%;\" prefix-icon = \"iconfont icon-yonghu\" v-model=\"form.UserCode\"  placeholder=\"请输入学号\"></el-input>\r\n\t\t\t\t<el-input style=\"width: 85%;margin-top: 5%;\" prefix-icon = \"iconfont icon-banjiguanli\" v-model=\"form.CLassCode\"  placeholder=\"请输入班级号\" @keyup.enter.native=\"login\"></el-input>\r\n\t\t\t\t<el-button style=\"width: 85%;margin-top: 15%;height: 50px;\" type=\"primary\" @click = \"login()\">登录</el-button>\r\n\t\t\t</div> \r\n\t  </el-dialog>\r\n\t  \r\n\t</el-container>\n</template>\n\n<script>\r\n\timport $ from '../../node_modules/jquery/dist/jquery.js'\r\n\timport store from '../store.js'\r\n\timport flv from 'flv.js'\r\nexport default {\r\n\tstore,\r\n\tcreated(){\r\n\t\tif(flv.isSupported()){\r\n\t\t\tthis.player = flv.createPlayer({\r\n\t\t\ttype: 'flv',\r\n\t\t\turl: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t\tisLive: true,\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t\r\n\tdata(){\r\n\t\treturn{\r\n\t\t\tdialogFormVisible :false,\r\n\t\t\tplayer : null,\r\n\t\t\tplaying: false,\r\n\t\t\tscreenWidth: 0,//屏幕宽度\r\n\t\t\tscreenHeight: 0,//屏幕高度\r\n\t\t\twebsock:null,\r\n\t\t\tdrawx:100,\r\n\t\t\tdrawy:500,\r\n\t\t\t//页面启动自动接连\r\n\t\t\tform:{\r\n\t\t\t\t\"ConnectionDetail\": 4,\r\n\t\t\t\t\"LocalIp\": \"192.168.51.198\",\r\n\t\t\t\t\"AimIp\": \"101.34.101.58\",\r\n\t\t\t\t\"UserType\": 0,\r\n\t\t\t\t// \"UserName\": store.state.userName,\r\n\t\t\t\t// \"UserCode\": store.state.userCode,\r\n\t\t\t\t// \"CLassCode\": store.state.classCode,\r\n\t\t\t\t\"UserName\": \"\",\r\n\t\t\t\t\"UserCode\": \"17003\",\r\n\t\t\t\t\"CLassCode\": \"5327\",\r\n\t\t\t\t\"JsonType\": 4,\r\n\t\t\t\t\"JsonData\": \"登录到服务器\",\r\n\t\t\t\t\"ContentSocket\": null\r\n\t\t\t},\r\n\t\t\tcountnum:0,\r\n\t\t\t//坐标点对象\r\n\t\t\tpointObj:null,\r\n\t\t\ttextarea: '',\r\n\t\t\tiscandraw:false,\r\n\t\t\tflag: false,\r\n\t\t\t  x: 0,\r\n\t\t\t  y: 0,\r\n\t\t\tpointArray:[],\r\n\t\t\ttestjson:{\"ConnectionDetail\":4,\"LocalIp\":\"192.168.51.198\",\"AimIp\":\"192.168.51.198\",\"UserType\":0,\r\n\t\t\t\"UserName\":123,\"UserCode\":123,\"CLassCode\":5327,\"JsonType\":6,\r\n\t\t\t\"JsonData\":\"\",\r\n\t\t\t\"ContentSocket\":null},\r\n\t\t\tChatArray:[],\r\n\t\t\tbgimg:\"http://qwf43oqfq.hn-bkt.clouddn.com/%E6%A1%8C%E9%9D%A2%E5%A3%81%E7%BA%B8.jpg\",\r\n\t\t\timgObj:null,\r\n\t\t\timgSrcRoot:'http://qwf43oqfq.hn-bkt.clouddn.com/',\r\n\t\t\timgData:null,\r\n\t\t\ttemp: null,\r\n\t\t\tpdfheight:0,\r\n\t\t\tpdfwidth:0,\r\n\t\t\tupPicture:null,\r\n\t\t\tnowPicture:null,\r\n\t\t}\r\n\t},\r\n\t\r\n\tmethods:{\r\n\t\tlogin(){\r\n\t\t\tthis.dialogFormVisible = false\r\n\t\t\tthis.initWebSocket()\r\n\t\t},\r\n\t\t\r\n\t\tclearcanvas(){\r\n\t\t\tvar context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\t context.canvas.width = context.canvas.width;\r\n\t\t},\r\n\t\t\r\n\t\tcanvascopy(){\r\n\t\t          var context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t          var width = context.canvas.width;\r\n\t\t          var height = context.canvas.height;\r\n\t\t          this.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\t\t  var newCanvas = $(\"<canvas>\")\r\n\t\t\t\t      .attr(\"width\", this.imgData.width)\r\n\t\t\t\t      .attr(\"height\", this.imgData.height)[0];\r\n\t\t\t\t  newCanvas.getContext(\"2d\").putImageData(this.imgData, 0, 0);\r\n\t\t\t\t  this.temp = newCanvas\r\n\t\t      },\r\n\t\t\r\n\t\tcanvaspaste(){\r\n\t\t        var context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\t\tvar width = context.canvas.width;\r\n\t\t\t\tvar height = context.canvas.height;\r\n\t\t\t\tcontext.scale(width / this.temp.width ,height / this.temp.height)\r\n\t\t       context.drawImage(this.temp,0,0)\r\n\t\t\t   \r\n\t\t\t   this.imgData = context.getImageData(0, 0, width, height);\r\n\t\t\t   var newCanvas = $(\"<canvas>\")\r\n\t\t\t       .attr(\"width\", this.imgData.width)\r\n\t\t\t       .attr(\"height\", this.imgData.height)[0];\r\n\t\t\t   newCanvas.getContext(\"2d\").putImageData(this.imgData, 0, 0);\r\n\t\t\t   \r\n\t\t\t   // context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\t   context.canvas.width  = width\r\n\t\t\t   context.canvas.height  = height\r\n\t\t\t    context.drawImage(newCanvas,0,0)\r\n\t\t\t   \r\n\t\t\t\tconsole.log(width + \" + \" + height)\r\n\t\t},\r\n\t\t\r\n\t\trevocation(){\r\n\t\t\t// this.canvaspaste();\r\n\t\t\tvar context = document.getElementById(\"mycanvas\").getContext('2d');\r\n\t\t\t context.canvas.width = context.canvas.width;\r\n\t\t\tthis.canvaspaste()\r\n\t\t},\r\n\t\t\r\n\t\tloadImg(){\r\n\t\t\tconst that = this\r\n\t\t\tvar beauty = new Image()\r\n\t\t\tbeauty.crossOrigin = 'Anonymous' //这是是需要加的\r\n\t\t\tbeauty.src = this.imgSrcRoot+this.imgObj\r\n\t\t\tconsole.log(444+beauty.src)\r\n\t\t\tbeauty.onload = function(){\r\n\t\t\t\t// 等比例缩放图片\r\n\t\t\t\tvar scale = 1;\r\n\t\t\t\tvar mycv = document.getElementById(\"mycanvas\")\r\n\t\t\t\tvar myctx = mycv.getContext(\"2d\")\r\n\t\t\t\tthis.width = mycv.width/2\r\n\t\t\t\tthis.height = mycv.height\r\n\t\t\t\tconsole.log(this.width + \"+\" + this.height)\r\n\t\t\t\tmyctx.drawImage(this, 0, 0, this.width, this.height);  // 加载图片\r\n\t\t\t\t//myctx.drawImage(this, 0, 0)\r\n\t\t\t\tthat.canvascopy()\r\n\t\t    };\r\n\t\t},\r\n\t\t\r\n\t\tinitCanvas(){\r\n\t\t\tconsole.log(\"initcanvas\")\r\n\t\t\t\tvar canvas = document.getElementById(\"mycanvas\")\r\n\t\t\t\tvar context = canvas.getContext('2d')\r\n\t\t\t\tcanvas.width = window.innerWidth * 0.75;\r\n\t\t\t\tcanvas.height =  window.innerHeight * 0.85;\r\n\t\t\t\tcanvas.style.width = window.innerWidth * 0.75;\r\n\t\t\t\tcanvas.style.height =  window.innerHeight * 0.85;\r\n\t\t},\r\n\t\t\r\n\t\tdrawline(){\r\n\t\t\tconst that = this\r\n\t\t\tconsole.log(\"可以画了\")\r\n\t\t\tconsole.log(window.innerWidth)\r\n\t\t\tvar canvas = document.getElementById(\"mycanvas\")\r\n\t\t\tvar context = canvas.getContext('2d')\r\n\t\t\t// canvas.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.height =  window.innerHeight * 0.85;\r\n\t\t\t// canvas.style.width = window.innerWidth * 0.75;\r\n\t\t\t// canvas.style.height =  window.innerHeight * 0.85;\r\n\t\t\tvar canvasWidth = canvas.width\r\n\t\t\tvar canvasHeight = canvas.height\r\n\t\t\tcanvas.onmousedown = function(e){\r\n\t\t\t\tthat.pointArray = []\r\n\t\t\t\tvar point = {}\r\n\t\t\t\tvar count = []\r\n\t\t\t\tvar mid = []\r\n\t\t\t\tvar e = e ||window.event;\r\n\t\t\t\tvar ox = e.clientX - window.innerWidth * 0.025 ;\r\n\t\t\t\tvar oy = e.clientY - window.innerHeight * 0.11;\r\n\t\t\t\tcontext.moveTo(ox,oy);\r\n\t\t\t\t\r\n\t\t\t\tdocument.onmousemove = function(e){\r\n\t\t\t\t\t// setTimeout(\"showLogin()\",1000); \r\n\t\t\t\t\tvar e = e || window.event; \r\n\t\t\t\t\tvar ox2 = e.clientX -  window.innerWidth * 0.025 ;\r\n\t\t\t\t\tvar oy2 = e.clientY - window.innerHeight * 0.11;\r\n\t\t\t\t\t\r\n\t\t\t\t\tpoint.X = parseFloat(that.BoradWidth - ((that.BoradWidth * (e.clientX -  window.innerWidth * 0.025)) / canvasWidth)).toFixed(4);\r\n\t\t\t\t\tpoint.Y =  parseFloat(that.BoradHeight - ((that.BoradHeight * (e.clientY -  window.innerHeight * 0.11)) / canvasHeight)).toFixed(4);\r\n\t\t\t\t\tconsole.log(point.X + \"+++\" + point.Y)\r\n\t\t\t\t\tcontext.lineTo(ox2,oy2);\r\n\t\t\t\t\tcontext.stroke();\r\n\t\t\t\t\tcount.push(point)\r\n\t\t\t\t\tpoint = {}\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t \r\n\t\t\t\tdocument.onmouseup  = function(e){\r\n\t\t\t\t\tdocument.onmousemove =null;\r\n\t\t\t\t\tdocument.onmouseup = null;\r\n\t\t\t\t\tfor(var i = 0;i < count.length; i++){\r\n\t\t\t\t\t   mid.push(count[i]) \r\n\t\t\t\t\t   mid.push(count[i + 1])\r\n\t\t\t\t\t   that.pointArray.push(mid)\r\n\t\t\t\t\t   mid = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.form.JsonType = 7\r\n\t\t\t\t\tvar msg = JSON.stringify(that.pointArray)\r\n\t\t\t\t\tthat.form.JsonData = msg\r\n\t\t\t\t\tthat.countnum++ \r\n\t\t\t\t\tthat.canvascopy()\r\n\t\t\t\t}\r\n\t\t\t\t\t   \r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconsole.log(1111111111111111111111111111111111111111111111)\r\n\t\t\t\tconsole.log(canvasWidth)\r\n\t\t\t\tconsole.log(canvasHeight)\r\n\t\t\t\tfor(var i = 0;i < this.pointObj.length; i++){\r\n\t\t\t\t\tcontext.moveTo(canvasWidth - this.pointObj[i][0].X  / this.BoradWidth *canvasWidth,canvasHeight - this.pointObj[i][0].Y / this.BoradHeight *canvasHeight) \r\n\t\t\t\t\tcontext.lineTo(canvasWidth - this.pointObj[i][1].X / this.BoradWidth *canvasWidth,canvasHeight - this.pointObj[i][1].Y / this.BoradHeight *canvasHeight)\r\n\t\t\t\t\tcontext.strokeStyle = \"black\"\r\n\t\t\t\t\tcontext.lineWidth = 1.5;\r\n\t\t\t\t\tcontext.stroke()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\r\n\t\tsendMessage(){\r\n\t\t\tconst that = this\r\n\t\t\tif(this.textarea === null || this.textarea === '' || this.textarea === \" \"){\r\n\t\t\t\talert(\"别nm发空消息\")\r\n\t\t\t}else{\r\n\t\t\t\tthat.form.JsonType = 6\r\n\t\t\t\tthat.form.JsonData = that.textarea\r\n\t\t\t\tthat.textarea = null\r\n\t\t\t\tvar msg = JSON.stringify(that.form);\r\n\t\t\t\tthat.websocketsend(msg)\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tlogout(){\r\n\t\t\tthis.$router.push(\"/Login\")\r\n\t\t\tthis.websock.close() //离开路由之后断开websocket连接\r\n\t\t},\r\n\r\n\t\tinitWebSocket(){ //初始化weosocket\r\n\t\t\t//192.168.51.198\r\n\t\t\t//101.34.101.58\r\n\t\t\t// const wsuri = \"ws://192.168.51.132:9999\"; \r\n\t\t\t// const wsuri = \"ws://192.168.51.198:9999\"; \r\n\t\t\tconst wsuri = \"ws://101.34.101.58:9999\";    \r\n\t\t\tthis.websock = new WebSocket(wsuri);\r\n\t\t\tthis.websock.onopen = this.websocketonopen;\r\n\t\t\tthis.websock.onmessage = this.websocketonmessage;\r\n\t\t\tthis.websock.onerror = this.websocketonerror;\r\n\t\t\tthis.websock.onclose = this.websocketclose;\r\n\t\t},\r\n\t\t\r\n\t\twebsocketonopen(){ //连接建立之后执行send方法发送数据\r\n\t\t\tvar msg = JSON.stringify(this.form);//转化为json字符串\r\n\t\t\tconsole.log(this.form);\r\n\t\t\tconsole.log(msg); \r\n\t\t\tthis.websocketsend(msg);\r\n\t\t},\r\n\t\t\r\n\t\twebsocketonerror(){//连接建立失败重连\r\n\t\t\talert(\"正在重新连接\");\r\n\t\t},\r\n\t\t\r\n\t\twebsocketonmessage(e){ //数据接收\r\n\t\t\tvar jsonObj = eval('(' + e.data + ')');\r\n\t\t\tconsole.log(jsonObj)\r\n\t\t\tconsole.log(jsonObj.JsonType)\r\n\t\t\tif(jsonObj.JsonData == \"false\"){\r\n\t\t\t\talert(\"登陆失败\")\r\n\t\t\t}else{\r\n\t\t\t\tif(jsonObj.JsonData == \"true\"){\r\n\t\t\t\t\talert(\"登陆成功\")\r\n\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth\r\n\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(jsonObj.JsonType == 3){\r\n\t\t\t\t\t\tconsole.log(\"这是画线！！\");\r\n\t\t\t\t\t\tthis.canvascopy();\r\n\t\t\t\t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t\t\t\tthis.pointObj = pointObj\r\n\t\t\t\t\t\tthis.BoradWidth = jsonObj.BoradWidth\r\n\t\t\t\t\t\tthis.BoradHeight = jsonObj.BoradHeight\r\n\t\t\t\t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\r\n\t\t\t\t\t}else if(jsonObj.JsonType == 8){\r\n\t\t\t\t\t\tconsole.log(\"这是pdf！！\");\r\n\t\t\t\t\t\t// console.log(\"这是清空画板\")\r\n\t\t\t\t\t\t//  var c=document.getElementById(\"mycanvas\");  \r\n\t\t\t\t\t\t//     var cxt=c.getContext(\"2d\");  \r\n\t\t\t\t\t\t//     c.height=c.height;  \r\n\t\t\t\t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t\t\t\tthis.imgObj = imgObj\r\n\t\t\t\t\t\tconsole.log(2333+this.imgObj)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(jsonObj.JsonType == 2){\r\n\t\t\t\t\t\tconsole.log(\"这是消息！！\");\r\n\t\t\t\t\t\tvar count = {}\r\n\t\t\t\t\t\tcount.TeacherName = jsonObj.UserName,\r\n\t\t\t\t\t\tcount.TeacherSay = jsonObj.JsonData,\r\n\t\t\t\t\t\tconsole.log(count)\r\n\t\t\t\t\t\tthis.ChatArray.push(count)\r\n\t\t\t\t\t}else if(jsonObj.JsonType == 10){\r\n\t\t\t\t\t\tconsole.log(\"这是撤销！！\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.revocation();\r\n\t\t\t\t\t}else if(jsonObj.JsonType == 9){\r\n\t\t\t\t\t\tconsole.log(\"这是清空花板！！\");\r\n\t\t\t\t\t\tvar c=document.getElementById(\"mycanvas\");\r\n\t\t\t\t\t\tc.height=c.height;  \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// if(jsonObj.ConnectionDetail = 8){\r\n\t\t\t// \tif(jsonObj.JsonData == \"false\"){\r\n\t\t\t// \tthis.$message.error('登陆失败');\r\n\t\t\t// \t}else{\r\n\t\t\t// \t\tif(jsonObj.JsonType == 4){\r\n\t\t\t// \t\t\tconst that = this\r\n\t\t\t// \t\t this.$message({\r\n\t\t\t// \t\t\t\t  message: '登陆成功',\r\n\t\t\t// \t\t\t\t  type: 'success'\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \tthis.openLogin = false;\r\n\t\t\t// \t\t}\r\n\t\t\t\t\t\r\n\t\t\t// \telse if(jsonObj.JsonType == 8){\r\n\t\t\t// \t\t\tvar imgObj = jsonObj.JsonData;\r\n\t\t\t// \t\t\tthis.imgObj = imgObj\r\n\t\t\t// \t\t\tconsole.log(2333+this.imgObj)\r\n\t\t\t// \t\t}else if(jsonObj.JsonType == 3){\r\n\t\t\t// \t\t\tthis.canvascopy();\r\n\t\t\t// \t\t\tvar pointObj = eval('(' + jsonObj.JsonData + ')');\r\n\t\t\t// \t\t\tthis.pointObj = pointObj\r\n\t\t\t// \t\t\tthis.BoradWidth = jsonObj.BoradWidth\r\n\t\t\t// \t\t\tthis.BoradHeight = jsonObj.BoradHeight\r\n\t\t\t// \t\t\tconsole.log(\"这是手写版的宽高：\" + jsonObj.BoradWidth + jsonObj.BoradHeight)\r\n\t\t\t// \t\t}else{\r\n\t\t\t// \t\t\talert(\"这是其他的\")\r\n\t\t\t// \t\t}\r\n\t\t\t// \t// this.loginbtn = false\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\twebsocketsend(Data){//数据发送\r\n\t\t\tconsole.log(111 + Data)\r\n\t\t\tconsole.log(\"这是数据长度\" + Data.length )\r\n\t\t\tthis.websock.send(Data);\r\n\t\t},\r\n\t\t\r\n\t\twebsocketclose(e){  //关闭\r\n\t\t\tconsole.log('断开连接',e);\r\n\t\t},\t\r\n\t\r\n\t},\r\n\t\r\n\tmounted() {\r\n\t\tif (flv.isSupported()) {\r\n\t\t\t  var videoElement = document.getElementById('myvideo')\r\n\t\t\t  var flvPlayer = flv.createPlayer({\r\n\t\t\t   type: 'flv',\r\n\t\t\t   url: 'http://101.34.101.58/live?port=9988&&app=live&&stream=test',\r\n\t\t\t     isLive: true,\r\n\t\t\t\t fluid:true,\r\n\t\t\t\t// 首帧等待时长\r\n\t\t\t\t// stashInitialSize: 2\r\n\t\t\t    // hasAudio: false,//是否有音频轨道\r\n\t\t\t  },\r\n\t\t\t  {\r\n\t\t\t\t   // lazyLoadMaxDuration: 3 * 60,\r\n\t\t\t\t   // enableWorker: true,\r\n\t\t\t\t// 启用IO隐藏缓冲区。如果您需要实时（最小延迟）来进行实时流播放，则设置为false，但是如果网络抖动，则可能会停顿。\r\n\t\t        enableStashBuffer: false,//是否开启播放器端缓存\r\n\t\t\t\tfixAudioTimestampGap:false,//音视频同步\r\n\t\t\t\tisLive:true,//是否为直播流\r\n\t\t\t\t// autoCleanupMaxBackwardDuration:1,\r\n\t\t\t\t// withCredentials: false,\r\n\t\t\t\t // cors: true,        \r\n\t\t                     },\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t  flvPlayer.attachMediaElement(videoElement)\r\n\t\t\t  flvPlayer.load()\r\n\t\t\t  flvPlayer.play()\r\n\t\t} \r\n\t\t\r\n\t\tvar _this = this;\r\n\t\t\t\t\t\twindow.onresize = function(){ // 定义窗口大小变更通知事件\r\n\t\t                _this.screenWidth = document.documentElement.clientWidth; //窗口宽度\r\n\t\t                _this.screenHeight = document.documentElement.clientHeight; //窗口高度\r\n\t\t\t\t\t\tconsole.log(document.documentElement.clientWidth)\r\n\t\t\t\t\t\tconsole.log(document.documentElement.clientWidth)\r\n\t\t\t\t\t\t\r\n\t\t            };\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.initCanvas()\r\n\t\t\t\t\t// this.initWebSocket()\r\n\t\t\t\t\tthis.drawline()\r\n\t\t\r\n\t},\r\n\t\r\n\tcomputed:{\r\n\t\tgetuserCode(){\r\n\t\t\treturn this.$store.state.userCode;\r\n\t\t},\r\n\t\tgetclassCode(){\r\n\t\t   return this.$store.state.classCode;\r\n\t\t},\r\n\t\t\r\n\t },\r\n\t\r\n\twatch:{\r\n\t       pointObj: {\r\n\t         deep: true,\r\n\t         handler: function (newVal,oldVal){\r\n\t\t\t\t this.drawline()\r\n\t         }\r\n\t       },\r\n\r\n\t\t   countnum: {\r\n\t\t     deep: true,\r\n\t\t     handler: function (newVal,oldVal){\r\n\t\t\t\tvar msg = JSON.stringify(this.form);\r\n\t\t   \t\tthis.websocketsend(msg)\r\n\t\t\t\tthis.drawline()\r\n\t\t     }\r\n\t\t   },\r\n\t\timgObj: {\n\t\t\t\t deep: true,\n\t\t\t\t handler: function (newVal,oldVal){\n\t\t\t\t\t this.loadImg()  \r\n\t\t\t\t\t\n\t\t\t\t }\n\t\t},\r\n\t\t'screenWidth':function(val){ //监听屏幕宽度变化\r\n\t\t\tconsole.log(123456)\r\n\t\t\t\t\t\tconsole.log(this.imgData)\r\n\t\t                var canvas = document.getElementById(\"mycanvas\")\r\n\t\t                var context = canvas.getContext('2d')\r\n\t\t                canvas.width = window.innerWidth * 0.75;\r\n\t\t                canvas.height =  window.innerHeight * 0.85;\r\n\t\t                canvas.style.width = window.innerWidth * 0.75;\r\n\t\t                canvas.style.height =  window.innerHeight * 0.85;\r\n\t\t\t\t\t\tconsole.log(window.innerWidth)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.canvaspaste()\r\n\t\t            },\r\n\t\t'screenHeight':function(){ //监听屏幕高度变化\r\n\t\t\tconsole.log(123456)\r\n\t\t   var canvas = document.getElementById(\"mycanvas\")\r\n\t\t   var context = canvas.getContext('2d')\r\n\t\t   canvas.width = window.innerWidth * 0.75;\r\n\t\t   canvas.height =  window.innerHeight * 0.85;\r\n\t\t   canvas.style.width = window.innerWidth * 0.75;\r\n\t\t   canvas.style.height =  window.innerHeight * 0.85;\r\n\t\t   this.canvaspaste()\r\n\t\t}\r\n\t},\r\n\t   \r\n}\n</script>\n\n<style  scoped lang=\"less\">\r\n\t\r\n\t.el-header{\r\n\t\t background-color: #373d41;\r\n\t\t display: flex;\r\n\t\t justify-content: space-between;\r\n\t\t padding-left: 20px;\r\n\t\t align-items: center;\r\n\t\t color: #FFFFFF;\r\n\t\t font-size: 20px;\r\n\t\t >div{\r\n\t\t \tdisplay: flex;\r\n\t\t \talign-items: center;\r\n\t\t \t>span{\r\n\t\t \t\tmargin-left: 20px;\r\n\t\t \t}\r\n\t\t }\r\n\t } \r\n\t \r\n\t.messagediv{\r\n\t\t width: 100%;\r\n\t\t height: 100%;\r\n\t\t .el-card /deep/ .el-card__body {\r\n\t\t     height: 94%;\r\n\t\t\t\r\n\t\t }\r\n\t\t \r\n\t\t .box-card {\r\n\t\t\twidth: 100%;\r\n\t\t\t\r\n\t\t\tbackground-color: white;\r\n\t\t\ttext-align: left;\r\n\t\t\toverflow-y: auto;\r\n\t\t\toverflow-x:hidden;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\theight: 100%;\r\n\t\t\t.text {\r\n\t\t\t\tfont-size: 15px;\t\t\t\t\t\t\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\t  \r\n\t\t\t}\r\n\t\t\t.item {\r\n\t\t\t\tline-height: 20px;\r\n\t\t\t}\r\n\t\t\t.el-divider{\r\n\t\t\t\tmargin: 10px 0;\r\n\t\t\t\tbackground: 0 0;\r\n\t\t\t\tborder-top: 1px solid #0b0b0c;\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\t\t}\t \r\n\t}\r\n\r\n\t.el-footer {\r\n\t\tbackground-color: #B3C0D1;\r\n\t\t// background-color: #f9f4dc;\r\n\t\tcolor: #333;\r\n\t\ttext-align: center;\r\n\t\tline-height: 100%;\r\n\t}\r\n\r\n\t.el-aside {\r\n\t\tbackground-color: rgb(#ced6e0);\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.el-main {\r\n\t\tbackground-color: black;\r\n\t\tcolor: #333;\r\n\t\ttext-align: center;\r\n\t\tpadding: 0;\r\n\t}  \n</style>\n"]}]}